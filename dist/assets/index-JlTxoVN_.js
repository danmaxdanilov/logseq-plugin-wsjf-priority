(function(){const K=document.createElement("link").relList;if(K&&K.supports&&K.supports("modulepreload"))return;for(const $ of document.querySelectorAll('link[rel="modulepreload"]'))lt($);new MutationObserver($=>{for(const G of $)if(G.type==="childList")for(const U of G.addedNodes)U.tagName==="LINK"&&U.rel==="modulepreload"&&lt(U)}).observe(document,{childList:!0,subtree:!0});function et($){const G={};return $.integrity&&(G.integrity=$.integrity),$.referrerPolicy&&(G.referrerPolicy=$.referrerPolicy),$.crossOrigin==="use-credentials"?G.credentials="include":$.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function lt($){if($.ep)return;$.ep=!0;const G=et($);fetch($.href,G)}})();var zr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ur={exports:{}};/*! For license information please see lsplugin.user.js.LICENSE.txt */ur.exports;var Un;function jo(){return Un||(Un=1,(function(q,K){(function(et,lt){q.exports=lt()})(self,(()=>(()=>{var et={227:(U,f,E)=>{var j=E(155);f.formatArgs=function(R){if(R[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+R[0]+(this.useColors?"%c ":" ")+"+"+U.exports.humanize(this.diff),!this.useColors)return;const Y="color: "+this.color;R.splice(1,0,Y,"color: inherit");let b=0,d=0;R[0].replace(/%[a-zA-Z%]/g,(x=>{x!=="%%"&&(b++,x==="%c"&&(d=b))})),R.splice(d,0,Y)},f.save=function(R){try{R?f.storage.setItem("debug",R):f.storage.removeItem("debug")}catch{}},f.load=function(){let R;try{R=f.storage.getItem("debug")}catch{}return!R&&j!==void 0&&"env"in j&&(R=j.env.DEBUG),R},f.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},f.storage=(function(){try{return localStorage}catch{}})(),f.destroy=(()=>{let R=!1;return()=>{R||(R=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),f.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],f.log=console.debug||console.log||(()=>{}),U.exports=E(447)(f);const{formatters:k}=U.exports;k.j=function(R){try{return JSON.stringify(R)}catch(Y){return"[UnexpectedJSONParseError]: "+Y.message}}},447:(U,f,E)=>{U.exports=function(j){function k(b){let d,x,u,S=null;function y(...O){if(!y.enabled)return;const D=y,A=Number(new Date),L=A-(d||A);D.diff=L,D.prev=d,D.curr=A,d=A,O[0]=k.coerce(O[0]),typeof O[0]!="string"&&O.unshift("%O");let i=0;O[0]=O[0].replace(/%([a-zA-Z%])/g,((c,m)=>{if(c==="%%")return"%";i++;const g=k.formatters[m];if(typeof g=="function"){const W=O[i];c=g.call(D,W),O.splice(i,1),i--}return c})),k.formatArgs.call(D,O),(D.log||k.log).apply(D,O)}return y.namespace=b,y.useColors=k.useColors(),y.color=k.selectColor(b),y.extend=R,y.destroy=k.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>S!==null?S:(x!==k.namespaces&&(x=k.namespaces,u=k.enabled(b)),u),set:O=>{S=O}}),typeof k.init=="function"&&k.init(y),y}function R(b,d){const x=k(this.namespace+(d===void 0?":":d)+b);return x.log=this.log,x}function Y(b){return b.toString().substring(2,b.toString().length-2).replace(/\.\*\?$/,"*")}return k.debug=k,k.default=k,k.coerce=function(b){return b instanceof Error?b.stack||b.message:b},k.disable=function(){const b=[...k.names.map(Y),...k.skips.map(Y).map((d=>"-"+d))].join(",");return k.enable(""),b},k.enable=function(b){let d;k.save(b),k.namespaces=b,k.names=[],k.skips=[];const x=(typeof b=="string"?b:"").split(/[\s,]+/),u=x.length;for(d=0;d<u;d++)x[d]&&((b=x[d].replace(/\*/g,".*?"))[0]==="-"?k.skips.push(new RegExp("^"+b.slice(1)+"$")):k.names.push(new RegExp("^"+b+"$")))},k.enabled=function(b){if(b[b.length-1]==="*")return!0;let d,x;for(d=0,x=k.skips.length;d<x;d++)if(k.skips[d].test(b))return!1;for(d=0,x=k.names.length;d<x;d++)if(k.names[d].test(b))return!0;return!1},k.humanize=E(824),k.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(j).forEach((b=>{k[b]=j[b]})),k.names=[],k.skips=[],k.formatters={},k.selectColor=function(b){let d=0;for(let x=0;x<b.length;x++)d=(d<<5)-d+b.charCodeAt(x),d|=0;return k.colors[Math.abs(d)%k.colors.length]},k.enable(k.load()),k}},996:U=>{var f=function(u){return(function(S){return!!S&&typeof S=="object"})(u)&&!(function(S){var y=Object.prototype.toString.call(S);return y==="[object RegExp]"||y==="[object Date]"||(function(O){return O.$$typeof===E})(S)})(u)},E=typeof Symbol=="function"&&Symbol.for?Symbol.for("react.element"):60103;function j(u,S){return S.clone!==!1&&S.isMergeableObject(u)?d((y=u,Array.isArray(y)?[]:{}),u,S):u;var y}function k(u,S,y){return u.concat(S).map((function(O){return j(O,y)}))}function R(u){return Object.keys(u).concat((function(S){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(S).filter((function(y){return Object.propertyIsEnumerable.call(S,y)})):[]})(u))}function Y(u,S){try{return S in u}catch{return!1}}function b(u,S,y){var O={};return y.isMergeableObject(u)&&R(u).forEach((function(D){O[D]=j(u[D],y)})),R(S).forEach((function(D){(function(A,L){return Y(A,L)&&!(Object.hasOwnProperty.call(A,L)&&Object.propertyIsEnumerable.call(A,L))})(u,D)||(Y(u,D)&&y.isMergeableObject(S[D])?O[D]=(function(A,L){if(!L.customMerge)return d;var i=L.customMerge(A);return typeof i=="function"?i:d})(D,y)(u[D],S[D],y):O[D]=j(S[D],y))})),O}function d(u,S,y){(y=y||{}).arrayMerge=y.arrayMerge||k,y.isMergeableObject=y.isMergeableObject||f,y.cloneUnlessOtherwiseSpecified=j;var O=Array.isArray(S);return O===Array.isArray(u)?O?y.arrayMerge(u,S,y):b(u,S,y):j(S,y)}d.all=function(u,S){if(!Array.isArray(u))throw new Error("first argument should be an array");return u.reduce((function(y,O){return d(y,O,S)}),{})};var x=d;U.exports=x},856:function(U){U.exports=(function(){function f(w){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},f(w)}function E(w,M){return E=Object.setPrototypeOf||function(B,X){return B.__proto__=X,B},E(w,M)}function j(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}}function k(w,M,B){return k=j()?Reflect.construct:function(X,gt,Tt){var wt=[null];wt.push.apply(wt,gt);var _e=new(Function.bind.apply(X,wt));return Tt&&E(_e,Tt.prototype),_e},k.apply(null,arguments)}function R(w){return Y(w)||b(w)||d(w)||u()}function Y(w){if(Array.isArray(w))return x(w)}function b(w){if(typeof Symbol<"u"&&w[Symbol.iterator]!=null||w["@@iterator"]!=null)return Array.from(w)}function d(w,M){if(w){if(typeof w=="string")return x(w,M);var B=Object.prototype.toString.call(w).slice(8,-1);return B==="Object"&&w.constructor&&(B=w.constructor.name),B==="Map"||B==="Set"?Array.from(w):B==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(B)?x(w,M):void 0}}function x(w,M){(M==null||M>w.length)&&(M=w.length);for(var B=0,X=new Array(M);B<M;B++)X[B]=w[B];return X}function u(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=Object.hasOwnProperty,y=Object.setPrototypeOf,O=Object.isFrozen,D=Object.getPrototypeOf,A=Object.getOwnPropertyDescriptor,L=Object.freeze,i=Object.seal,c=Object.create,m=typeof Reflect<"u"&&Reflect,g=m.apply,W=m.construct;g||(g=function(w,M,B){return w.apply(M,B)}),L||(L=function(w){return w}),i||(i=function(w){return w}),W||(W=function(w,M){return k(w,R(M))});var rt=Z(Array.prototype.forEach),it=Z(Array.prototype.pop),dt=Z(Array.prototype.push),jt=Z(String.prototype.toLowerCase),St=Z(String.prototype.toString),Pt=Z(String.prototype.match),Mt=Z(String.prototype.replace),p=Z(String.prototype.indexOf),T=Z(String.prototype.trim),I=Z(RegExp.prototype.test),ct=tt(TypeError);function Ot(w){return typeof w=="number"&&isNaN(w)}function Z(w){return function(M){for(var B=arguments.length,X=new Array(B>1?B-1:0),gt=1;gt<B;gt++)X[gt-1]=arguments[gt];return g(w,M,X)}}function tt(w){return function(){for(var M=arguments.length,B=new Array(M),X=0;X<M;X++)B[X]=arguments[X];return W(w,B)}}function F(w,M,B){var X;B=(X=B)!==null&&X!==void 0?X:jt,y&&y(w,null);for(var gt=M.length;gt--;){var Tt=M[gt];if(typeof Tt=="string"){var wt=B(Tt);wt!==Tt&&(O(M)||(M[gt]=wt),Tt=wt)}w[Tt]=!0}return w}function mt(w){var M,B=c(null);for(M in w)g(S,w,[M])===!0&&(B[M]=w[M]);return B}function Ct(w,M){for(;w!==null;){var B=A(w,M);if(B){if(B.get)return Z(B.get);if(typeof B.value=="function")return Z(B.value)}w=D(w)}function X(gt){return console.warn("fallback value for",gt),null}return X}var Rt=L(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Jt=L(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ut=L(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),at=L(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),At=L(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Ft=L(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Gt=L(["#text"]),te=L(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Ut=L(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Lt=L(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Vt=L(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),qr=i(/\{\{[\w\W]*|[\w\W]*\}\}/gm),$t=i(/<%[\w\W]*|[\w\W]*%>/gm),Zt=i(/\${[\w\W]*}/gm),fr=i(/^data-[\-\w.\u00B7-\uFFFF]/),Br=i(/^aria-[\-\w]+$/),Hr=i(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),be=i(/^(?:\w+script|data):/i),Wr=i(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Jr=i(/^html$/i),Gr=i(/^[a-z][.\w]*(-[.\w]+)+$/i),pr=function(){return typeof window>"u"?null:window},ie=function(w,M){if(f(w)!=="object"||typeof w.createPolicy!="function")return null;var B=null,X="data-tt-policy-suffix";M.currentScript&&M.currentScript.hasAttribute(X)&&(B=M.currentScript.getAttribute(X));var gt="dompurify"+(B?"#"+B:"");try{return w.createPolicy(gt,{createHTML:function(Tt){return Tt},createScriptURL:function(Tt){return Tt}})}catch{return console.warn("TrustedTypes policy "+gt+" could not be created."),null}};function Ie(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pr(),M=function(o){return Ie(o)};if(M.version="2.5.4",M.removed=[],!w||!w.document||w.document.nodeType!==9)return M.isSupported=!1,M;var B=w.document,X=w.document,gt=w.DocumentFragment,Tt=w.HTMLTemplateElement,wt=w.Node,_e=w.Element,we=w.NodeFilter,dr=w.NamedNodeMap,Vr=dr===void 0?w.NamedNodeMap||w.MozNamedAttrMap:dr,Zr=w.HTMLFormElement,Kr=w.DOMParser,Me=w.trustedTypes,Le=_e.prototype,ee=Ct(Le,"cloneNode"),hr=Ct(Le,"nextSibling"),Yr=Ct(Le,"childNodes"),xe=Ct(Le,"parentNode");if(typeof Tt=="function"){var Ve=X.createElement("template");Ve.content&&Ve.content.ownerDocument&&(X=Ve.content.ownerDocument)}var kt=ie(Me,B),Fe=kt?kt.createHTML(""):"",Se=X,Ze=Se.implementation,Xr=Se.createNodeIterator,mr=Se.createDocumentFragment,Qr=Se.getElementsByTagName,gr=B.importNode,Ke={};try{Ke=mt(X).documentMode?X.documentMode:{}}catch{}var Nt={};M.isSupported=typeof xe=="function"&&Ze&&Ze.createHTMLDocument!==void 0&&Ke!==9;var Kt,yt,Ne=qr,Ce=$t,nt=Zt,tn=fr,en=Br,yr=be,se=Wr,Ye=Gr,Pe=Hr,ht=null,Xe=F({},[].concat(R(Rt),R(Jt),R(ut),R(At),R(Gt))),vt=null,vr=F({},[].concat(R(te),R(Ut),R(Lt),R(Vt))),ft=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,Qe=null,br=!0,tr=!0,_r=!1,Re=!0,ae=!1,er=!0,Yt=!1,le=!1,rr=!1,ce=!1,Ue=!1,De=!1,wr=!0,re=!1,ze="user-content-",nr=!0,Ee=!1,ue={},fe=null,pe=F({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),de=null,xr=F({},["audio","video","img","source","image","track"]),or=null,Sr=F({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),$e="http://www.w3.org/1998/Math/MathML",qe="http://www.w3.org/2000/svg",qt="http://www.w3.org/1999/xhtml",he=qt,ne=!1,Be=null,rn=F({},[$e,qe,qt],St),nn=["application/xhtml+xml","text/html"],He="text/html",me=null,Cr=255,on=X.createElement("form"),kr=function(o){return o instanceof RegExp||o instanceof Function},Xt=function(o){me&&me===o||(o&&f(o)==="object"||(o={}),o=mt(o),Kt=Kt=nn.indexOf(o.PARSER_MEDIA_TYPE)===-1?He:o.PARSER_MEDIA_TYPE,yt=Kt==="application/xhtml+xml"?St:jt,ht="ALLOWED_TAGS"in o?F({},o.ALLOWED_TAGS,yt):Xe,vt="ALLOWED_ATTR"in o?F({},o.ALLOWED_ATTR,yt):vr,Be="ALLOWED_NAMESPACES"in o?F({},o.ALLOWED_NAMESPACES,St):rn,or="ADD_URI_SAFE_ATTR"in o?F(mt(Sr),o.ADD_URI_SAFE_ATTR,yt):Sr,de="ADD_DATA_URI_TAGS"in o?F(mt(xr),o.ADD_DATA_URI_TAGS,yt):xr,fe="FORBID_CONTENTS"in o?F({},o.FORBID_CONTENTS,yt):pe,ke="FORBID_TAGS"in o?F({},o.FORBID_TAGS,yt):{},Qe="FORBID_ATTR"in o?F({},o.FORBID_ATTR,yt):{},ue="USE_PROFILES"in o&&o.USE_PROFILES,br=o.ALLOW_ARIA_ATTR!==!1,tr=o.ALLOW_DATA_ATTR!==!1,_r=o.ALLOW_UNKNOWN_PROTOCOLS||!1,Re=o.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ae=o.SAFE_FOR_TEMPLATES||!1,er=o.SAFE_FOR_XML!==!1,Yt=o.WHOLE_DOCUMENT||!1,ce=o.RETURN_DOM||!1,Ue=o.RETURN_DOM_FRAGMENT||!1,De=o.RETURN_TRUSTED_TYPE||!1,rr=o.FORCE_BODY||!1,wr=o.SANITIZE_DOM!==!1,re=o.SANITIZE_NAMED_PROPS||!1,nr=o.KEEP_CONTENT!==!1,Ee=o.IN_PLACE||!1,Pe=o.ALLOWED_URI_REGEXP||Pe,he=o.NAMESPACE||qt,ft=o.CUSTOM_ELEMENT_HANDLING||{},o.CUSTOM_ELEMENT_HANDLING&&kr(o.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ft.tagNameCheck=o.CUSTOM_ELEMENT_HANDLING.tagNameCheck),o.CUSTOM_ELEMENT_HANDLING&&kr(o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ft.attributeNameCheck=o.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),o.CUSTOM_ELEMENT_HANDLING&&typeof o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ft.allowCustomizedBuiltInElements=o.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ae&&(tr=!1),Ue&&(ce=!0),ue&&(ht=F({},R(Gt)),vt=[],ue.html===!0&&(F(ht,Rt),F(vt,te)),ue.svg===!0&&(F(ht,Jt),F(vt,Ut),F(vt,Vt)),ue.svgFilters===!0&&(F(ht,ut),F(vt,Ut),F(vt,Vt)),ue.mathMl===!0&&(F(ht,At),F(vt,Lt),F(vt,Vt))),o.ADD_TAGS&&(ht===Xe&&(ht=mt(ht)),F(ht,o.ADD_TAGS,yt)),o.ADD_ATTR&&(vt===vr&&(vt=mt(vt)),F(vt,o.ADD_ATTR,yt)),o.ADD_URI_SAFE_ATTR&&F(or,o.ADD_URI_SAFE_ATTR,yt),o.FORBID_CONTENTS&&(fe===pe&&(fe=mt(fe)),F(fe,o.FORBID_CONTENTS,yt)),nr&&(ht["#text"]=!0),Yt&&F(ht,["html","head","body"]),ht.table&&(F(ht,["tbody"]),delete ke.tbody),L&&L(o),me=o)},je=F({},["mi","mo","mn","ms","mtext"]),Er=F({},["foreignobject","annotation-xml"]),ge=F({},["title","style","font","a","script"]),oe=F({},Jt);F(oe,ut),F(oe,at);var ir=F({},At);F(ir,Ft);var sn=function(o){var _=xe(o);_&&_.tagName||(_={namespaceURI:he,tagName:"template"});var v=jt(o.tagName),J=jt(_.tagName);return!!Be[o.namespaceURI]&&(o.namespaceURI===qe?_.namespaceURI===qt?v==="svg":_.namespaceURI===$e?v==="svg"&&(J==="annotation-xml"||je[J]):!!oe[v]:o.namespaceURI===$e?_.namespaceURI===qt?v==="math":_.namespaceURI===qe?v==="math"&&Er[J]:!!ir[v]:o.namespaceURI===qt?!(_.namespaceURI===qe&&!Er[J])&&!(_.namespaceURI===$e&&!je[J])&&!ir[v]&&(ge[v]||!oe[v]):!(Kt!=="application/xhtml+xml"||!Be[o.namespaceURI]))},xt=function(o){dt(M.removed,{element:o});try{o.parentNode.removeChild(o)}catch{try{o.outerHTML=Fe}catch{o.remove()}}},We=function(o,_){try{dt(M.removed,{attribute:_.getAttributeNode(o),from:_})}catch{dt(M.removed,{attribute:null,from:_})}if(_.removeAttribute(o),o==="is"&&!vt[o])if(ce||Ue)try{xt(_)}catch{}else try{_.setAttribute(o,"")}catch{}},jr=function(o){var _,v;if(rr)o="<remove></remove>"+o;else{var J=Pt(o,/^[\r\n\t ]+/);v=J&&J[0]}Kt==="application/xhtml+xml"&&he===qt&&(o='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+o+"</body></html>");var pt=kt?kt.createHTML(o):o;if(he===qt)try{_=new Kr().parseFromString(pt,Kt)}catch{}if(!_||!_.documentElement){_=Ze.createDocument(he,"template",null);try{_.documentElement.innerHTML=ne?Fe:pt}catch{}}var bt=_.body||_.documentElement;return o&&v&&bt.insertBefore(X.createTextNode(v),bt.childNodes[0]||null),he===qt?Qr.call(_,Yt?"html":"body")[0]:Yt?_.documentElement:bt},Or=function(o){return Xr.call(o.ownerDocument||o,o,we.SHOW_ELEMENT|we.SHOW_COMMENT|we.SHOW_TEXT|we.SHOW_PROCESSING_INSTRUCTION|we.SHOW_CDATA_SECTION,null,!1)},sr=function(o){return o instanceof Zr&&(o.__depth!==void 0&&typeof o.__depth!="number"||o.__removalCount!==void 0&&typeof o.__removalCount!="number"||typeof o.nodeName!="string"||typeof o.textContent!="string"||typeof o.removeChild!="function"||!(o.attributes instanceof Vr)||typeof o.removeAttribute!="function"||typeof o.setAttribute!="function"||typeof o.namespaceURI!="string"||typeof o.insertBefore!="function"||typeof o.hasChildNodes!="function")},ye=function(o){return f(wt)==="object"?o instanceof wt:o&&f(o)==="object"&&typeof o.nodeType=="number"&&typeof o.nodeName=="string"},Bt=function(o,_,v){Nt[o]&&rt(Nt[o],(function(J){J.call(M,_,v,me)}))},Ar=function(o){var _;if(Bt("beforeSanitizeElements",o,null),sr(o)||I(/[\u0080-\uFFFF]/,o.nodeName))return xt(o),!0;var v=yt(o.nodeName);if(Bt("uponSanitizeElement",o,{tagName:v,allowedTags:ht}),o.hasChildNodes()&&!ye(o.firstElementChild)&&(!ye(o.content)||!ye(o.content.firstElementChild))&&I(/<[/\w]/g,o.innerHTML)&&I(/<[/\w]/g,o.textContent)||v==="select"&&I(/<template/i,o.innerHTML)||o.nodeType===7||er&&o.nodeType===8&&I(/<[/\w]/g,o.data))return xt(o),!0;if(!ht[v]||ke[v]){if(!ke[v]&&Je(v)&&(ft.tagNameCheck instanceof RegExp&&I(ft.tagNameCheck,v)||ft.tagNameCheck instanceof Function&&ft.tagNameCheck(v)))return!1;if(nr&&!fe[v]){var J=xe(o)||o.parentNode,pt=Yr(o)||o.childNodes;if(pt&&J)for(var bt=pt.length-1;bt>=0;--bt){var Et=ee(pt[bt],!0);Et.__removalCount=(o.__removalCount||0)+1,J.insertBefore(Et,hr(o))}}return xt(o),!0}return o instanceof _e&&!sn(o)?(xt(o),!0):v!=="noscript"&&v!=="noembed"&&v!=="noframes"||!I(/<\/no(script|embed|frames)/i,o.innerHTML)?(ae&&o.nodeType===3&&(_=o.textContent,_=Mt(_,Ne," "),_=Mt(_,Ce," "),_=Mt(_,nt," "),o.textContent!==_&&(dt(M.removed,{element:o.cloneNode()}),o.textContent=_)),Bt("afterSanitizeElements",o,null),!1):(xt(o),!0)},ar=function(o,_,v){if(wr&&(_==="id"||_==="name")&&(v in X||v in on||v==="__depth"||v==="__removalCount"))return!1;if(!(tr&&!Qe[_]&&I(tn,_))){if(!(br&&I(en,_))){if(!vt[_]||Qe[_]){if(!(Je(o)&&(ft.tagNameCheck instanceof RegExp&&I(ft.tagNameCheck,o)||ft.tagNameCheck instanceof Function&&ft.tagNameCheck(o))&&(ft.attributeNameCheck instanceof RegExp&&I(ft.attributeNameCheck,_)||ft.attributeNameCheck instanceof Function&&ft.attributeNameCheck(_))||_==="is"&&ft.allowCustomizedBuiltInElements&&(ft.tagNameCheck instanceof RegExp&&I(ft.tagNameCheck,v)||ft.tagNameCheck instanceof Function&&ft.tagNameCheck(v))))return!1}else if(!or[_]){if(!I(Pe,Mt(v,se,""))){if((_!=="src"&&_!=="xlink:href"&&_!=="href"||o==="script"||p(v,"data:")!==0||!de[o])&&!(_r&&!I(yr,Mt(v,se,"")))){if(v)return!1}}}}}return!0},Je=function(o){return o!=="annotation-xml"&&Pt(o,Ye)},Tr=function(o){var _,v,J,pt;Bt("beforeSanitizeAttributes",o,null);var bt=o.attributes;if(bt){var Et={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:vt};for(pt=bt.length;pt--;){var Oe=_=bt[pt],Dt=Oe.name,Ht=Oe.namespaceURI;if(v=Dt==="value"?_.value:T(_.value),J=yt(Dt),Et.attrName=J,Et.attrValue=v,Et.keepAttr=!0,Et.forceKeepAttr=void 0,Bt("uponSanitizeAttribute",o,Et),v=Et.attrValue,!Et.forceKeepAttr&&(We(Dt,o),Et.keepAttr))if(Re||!I(/\/>/i,v))if(er&&I(/((--!?|])>)|<\/(style|title)/i,v))We(Dt,o);else{ae&&(v=Mt(v,Ne," "),v=Mt(v,Ce," "),v=Mt(v,nt," "));var It=yt(o.nodeName);if(ar(It,J,v)){if(!re||J!=="id"&&J!=="name"||(We(Dt,o),v=ze+v),kt&&f(Me)==="object"&&typeof Me.getAttributeType=="function"&&!Ht)switch(Me.getAttributeType(It,J)){case"TrustedHTML":v=kt.createHTML(v);break;case"TrustedScriptURL":v=kt.createScriptURL(v)}try{Ht?o.setAttributeNS(Ht,Dt,v):o.setAttribute(Dt,v),sr(o)?xt(o):it(M.removed)}catch{}}}else We(Dt,o)}Bt("afterSanitizeAttributes",o,null)}},an=function o(_){var v,J=Or(_);for(Bt("beforeSanitizeShadowDOM",_,null);v=J.nextNode();)if(Bt("uponSanitizeShadowNode",v,null),!Ar(v)){var pt=xe(v);v.nodeType===1&&(pt&&pt.__depth?v.__depth=(v.__removalCount||0)+pt.__depth+1:v.__depth=1),(v.__depth>=Cr||Ot(v.__depth))&&xt(v),v.content instanceof gt&&(v.content.__depth=v.__depth,o(v.content)),Tr(v)}Bt("afterSanitizeShadowDOM",_,null)};return M.sanitize=function(o){var _,v,J,pt,bt,Et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if((ne=!o)&&(o="<!-->"),typeof o!="string"&&!ye(o)){if(typeof o.toString!="function")throw ct("toString is not a function");if(typeof(o=o.toString())!="string")throw ct("dirty is not a string, aborting")}if(!M.isSupported){if(f(w.toStaticHTML)==="object"||typeof w.toStaticHTML=="function"){if(typeof o=="string")return w.toStaticHTML(o);if(ye(o))return w.toStaticHTML(o.outerHTML)}return o}if(le||Xt(Et),M.removed=[],typeof o=="string"&&(Ee=!1),Ee){if(o.nodeName){var Oe=yt(o.nodeName);if(!ht[Oe]||ke[Oe])throw ct("root node is forbidden and cannot be sanitized in-place")}}else if(o instanceof wt)(v=(_=jr("<!---->")).ownerDocument.importNode(o,!0)).nodeType===1&&v.nodeName==="BODY"||v.nodeName==="HTML"?_=v:_.appendChild(v);else{if(!ce&&!ae&&!Yt&&o.indexOf("<")===-1)return kt&&De?kt.createHTML(o):o;if(!(_=jr(o)))return ce?null:De?Fe:""}_&&rr&&xt(_.firstChild);for(var Dt=Or(Ee?o:_);J=Dt.nextNode();)if((J.nodeType!==3||J!==pt)&&!Ar(J)){var Ht=xe(J);J.nodeType===1&&(Ht&&Ht.__depth?J.__depth=(J.__removalCount||0)+Ht.__depth+1:J.__depth=1),(J.__depth>=Cr||Ot(J.__depth))&&xt(J),J.content instanceof gt&&(J.content.__depth=J.__depth,an(J.content)),Tr(J),pt=J}if(pt=null,Ee)return o;if(ce){if(Ue)for(bt=mr.call(_.ownerDocument);_.firstChild;)bt.appendChild(_.firstChild);else bt=_;return(vt.shadowroot||vt.shadowrootmod)&&(bt=gr.call(B,bt,!0)),bt}var It=Yt?_.outerHTML:_.innerHTML;return Yt&&ht["!doctype"]&&_.ownerDocument&&_.ownerDocument.doctype&&_.ownerDocument.doctype.name&&I(Jr,_.ownerDocument.doctype.name)&&(It="<!DOCTYPE "+_.ownerDocument.doctype.name+`>
`+It),ae&&(It=Mt(It,Ne," "),It=Mt(It,Ce," "),It=Mt(It,nt," ")),kt&&De?kt.createHTML(It):It},M.setConfig=function(o){Xt(o),le=!0},M.clearConfig=function(){me=null,le=!1},M.isValidAttribute=function(o,_,v){me||Xt({});var J=yt(o),pt=yt(_);return ar(J,pt,v)},M.addHook=function(o,_){typeof _=="function"&&(Nt[o]=Nt[o]||[],dt(Nt[o],_))},M.removeHook=function(o){if(Nt[o])return it(Nt[o])},M.removeHooks=function(o){Nt[o]&&(Nt[o]=[])},M.removeAllHooks=function(){Nt={}},M}return Ie()})()},729:U=>{var f=Object.prototype.hasOwnProperty,E="~";function j(){}function k(d,x,u){this.fn=d,this.context=x,this.once=u||!1}function R(d,x,u,S,y){if(typeof u!="function")throw new TypeError("The listener must be a function");var O=new k(u,S||d,y),D=E?E+x:x;return d._events[D]?d._events[D].fn?d._events[D]=[d._events[D],O]:d._events[D].push(O):(d._events[D]=O,d._eventsCount++),d}function Y(d,x){--d._eventsCount==0?d._events=new j:delete d._events[x]}function b(){this._events=new j,this._eventsCount=0}Object.create&&(j.prototype=Object.create(null),new j().__proto__||(E=!1)),b.prototype.eventNames=function(){var d,x,u=[];if(this._eventsCount===0)return u;for(x in d=this._events)f.call(d,x)&&u.push(E?x.slice(1):x);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},b.prototype.listeners=function(d){var x=E?E+d:d,u=this._events[x];if(!u)return[];if(u.fn)return[u.fn];for(var S=0,y=u.length,O=new Array(y);S<y;S++)O[S]=u[S].fn;return O},b.prototype.listenerCount=function(d){var x=E?E+d:d,u=this._events[x];return u?u.fn?1:u.length:0},b.prototype.emit=function(d,x,u,S,y,O){var D=E?E+d:d;if(!this._events[D])return!1;var A,L,i=this._events[D],c=arguments.length;if(i.fn){switch(i.once&&this.removeListener(d,i.fn,void 0,!0),c){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,x),!0;case 3:return i.fn.call(i.context,x,u),!0;case 4:return i.fn.call(i.context,x,u,S),!0;case 5:return i.fn.call(i.context,x,u,S,y),!0;case 6:return i.fn.call(i.context,x,u,S,y,O),!0}for(L=1,A=new Array(c-1);L<c;L++)A[L-1]=arguments[L];i.fn.apply(i.context,A)}else{var m,g=i.length;for(L=0;L<g;L++)switch(i[L].once&&this.removeListener(d,i[L].fn,void 0,!0),c){case 1:i[L].fn.call(i[L].context);break;case 2:i[L].fn.call(i[L].context,x);break;case 3:i[L].fn.call(i[L].context,x,u);break;case 4:i[L].fn.call(i[L].context,x,u,S);break;default:if(!A)for(m=1,A=new Array(c-1);m<c;m++)A[m-1]=arguments[m];i[L].fn.apply(i[L].context,A)}}return!0},b.prototype.on=function(d,x,u){return R(this,d,x,u,!1)},b.prototype.once=function(d,x,u){return R(this,d,x,u,!0)},b.prototype.removeListener=function(d,x,u,S){var y=E?E+d:d;if(!this._events[y])return this;if(!x)return Y(this,y),this;var O=this._events[y];if(O.fn)O.fn!==x||S&&!O.once||u&&O.context!==u||Y(this,y);else{for(var D=0,A=[],L=O.length;D<L;D++)(O[D].fn!==x||S&&!O[D].once||u&&O[D].context!==u)&&A.push(O[D]);A.length?this._events[y]=A.length===1?A[0]:A:Y(this,y)}return this},b.prototype.removeAllListeners=function(d){var x;return d?(x=E?E+d:d,this._events[x]&&Y(this,x)):(this._events=new j,this._eventsCount=0),this},b.prototype.off=b.prototype.removeListener,b.prototype.addListener=b.prototype.on,b.prefixed=E,b.EventEmitter=b,U.exports=b},717:U=>{typeof Object.create=="function"?U.exports=function(f,E){f.super_=E,f.prototype=Object.create(E.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:U.exports=function(f,E){f.super_=E;var j=function(){};j.prototype=E.prototype,f.prototype=new j,f.prototype.constructor=f}},824:U=>{var f=1e3,E=60*f,j=60*E,k=24*j,R=7*k,Y=365.25*k;function b(d,x,u,S){var y=x>=1.5*u;return Math.round(d/u)+" "+S+(y?"s":"")}U.exports=function(d,x){x=x||{};var u=typeof d;if(u==="string"&&d.length>0)return(function(S){if(!((S=String(S)).length>100)){var y=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(S);if(y){var O=parseFloat(y[1]);switch((y[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return O*Y;case"weeks":case"week":case"w":return O*R;case"days":case"day":case"d":return O*k;case"hours":case"hour":case"hrs":case"hr":case"h":return O*j;case"minutes":case"minute":case"mins":case"min":case"m":return O*E;case"seconds":case"second":case"secs":case"sec":case"s":return O*f;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return O;default:return}}}})(d);if(u==="number"&&isFinite(d))return x.long?(function(S){var y=Math.abs(S);return y>=k?b(S,y,k,"day"):y>=j?b(S,y,j,"hour"):y>=E?b(S,y,E,"minute"):y>=f?b(S,y,f,"second"):S+" ms"})(d):(function(S){var y=Math.abs(S);return y>=k?Math.round(S/k)+"d":y>=j?Math.round(S/j)+"h":y>=E?Math.round(S/E)+"m":y>=f?Math.round(S/f)+"s":S+"ms"})(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},520:(U,f,E)=>{var j=E(155),k=j.platform==="win32",R=E(539);function Y(i,c){for(var m=[],g=0;g<i.length;g++){var W=i[g];W&&W!=="."&&(W===".."?m.length&&m[m.length-1]!==".."?m.pop():c&&m.push(".."):m.push(W))}return m}function b(i){for(var c=i.length-1,m=0;m<=c&&!i[m];m++);for(var g=c;g>=0&&!i[g];g--);return m===0&&g===c?i:m>g?[]:i.slice(m,g+1)}var d=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,x=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function S(i){var c=d.exec(i),m=(c[1]||"")+(c[2]||""),g=c[3]||"",W=x.exec(g);return[m,W[1],W[2],W[3]]}function y(i){var c=d.exec(i),m=c[1]||"",g=!!m&&m[1]!==":";return{device:m,isUnc:g,isAbsolute:g||!!c[2],tail:c[3]}}function O(i){return"\\\\"+i.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var i="",c="",m=!1,g=arguments.length-1;g>=-1;g--){var W;if(g>=0?W=arguments[g]:i?(W=j.env["="+i])&&W.substr(0,3).toLowerCase()===i.toLowerCase()+"\\"||(W=i+"\\"):W=j.cwd(),!R.isString(W))throw new TypeError("Arguments to path.resolve must be strings");if(W){var rt=y(W),it=rt.device,dt=rt.isUnc,jt=rt.isAbsolute,St=rt.tail;if((!it||!i||it.toLowerCase()===i.toLowerCase())&&(i||(i=it),m||(c=St+"\\"+c,m=jt),i&&m))break}}return dt&&(i=O(i)),i+(m?"\\":"")+(c=Y(c.split(/[\\\/]+/),!m).join("\\"))||"."},u.normalize=function(i){var c=y(i),m=c.device,g=c.isUnc,W=c.isAbsolute,rt=c.tail,it=/[\\\/]$/.test(rt);return(rt=Y(rt.split(/[\\\/]+/),!W).join("\\"))||W||(rt="."),rt&&it&&(rt+="\\"),g&&(m=O(m)),m+(W?"\\":"")+rt},u.isAbsolute=function(i){return y(i).isAbsolute},u.join=function(){for(var i=[],c=0;c<arguments.length;c++){var m=arguments[c];if(!R.isString(m))throw new TypeError("Arguments to path.join must be strings");m&&i.push(m)}var g=i.join("\\");return/^[\\\/]{2}[^\\\/]/.test(i[0])||(g=g.replace(/^[\\\/]{2,}/,"\\")),u.normalize(g)},u.relative=function(i,c){i=u.resolve(i),c=u.resolve(c);for(var m=i.toLowerCase(),g=c.toLowerCase(),W=b(c.split("\\")),rt=b(m.split("\\")),it=b(g.split("\\")),dt=Math.min(rt.length,it.length),jt=dt,St=0;St<dt;St++)if(rt[St]!==it[St]){jt=St;break}if(jt==0)return c;var Pt=[];for(St=jt;St<rt.length;St++)Pt.push("..");return(Pt=Pt.concat(W.slice(jt))).join("\\")},u._makeLong=function(i){if(!R.isString(i))return i;if(!i)return"";var c=u.resolve(i);return/^[a-zA-Z]\:\\/.test(c)?"\\\\?\\"+c:/^\\\\[^?.]/.test(c)?"\\\\?\\UNC\\"+c.substring(2):i},u.dirname=function(i){var c=S(i),m=c[0],g=c[1];return m||g?(g&&(g=g.substr(0,g.length-1)),m+g):"."},u.basename=function(i,c){var m=S(i)[2];return c&&m.substr(-1*c.length)===c&&(m=m.substr(0,m.length-c.length)),m},u.extname=function(i){return S(i)[3]},u.format=function(i){if(!R.isObject(i))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof i);var c=i.root||"";if(!R.isString(c))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof i.root);var m=i.dir,g=i.base||"";return m?m[m.length-1]===u.sep?m+g:m+u.sep+g:g},u.parse=function(i){if(!R.isString(i))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof i);var c=S(i);if(!c||c.length!==4)throw new TypeError("Invalid path '"+i+"'");return{root:c[0],dir:c[0]+c[1].slice(0,-1),base:c[2],ext:c[3],name:c[2].slice(0,c[2].length-c[3].length)}},u.sep="\\",u.delimiter=";";var D=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,A={};function L(i){return D.exec(i).slice(1)}A.resolve=function(){for(var i="",c=!1,m=arguments.length-1;m>=-1&&!c;m--){var g=m>=0?arguments[m]:j.cwd();if(!R.isString(g))throw new TypeError("Arguments to path.resolve must be strings");g&&(i=g+"/"+i,c=g[0]==="/")}return(c?"/":"")+(i=Y(i.split("/"),!c).join("/"))||"."},A.normalize=function(i){var c=A.isAbsolute(i),m=i&&i[i.length-1]==="/";return(i=Y(i.split("/"),!c).join("/"))||c||(i="."),i&&m&&(i+="/"),(c?"/":"")+i},A.isAbsolute=function(i){return i.charAt(0)==="/"},A.join=function(){for(var i="",c=0;c<arguments.length;c++){var m=arguments[c];if(!R.isString(m))throw new TypeError("Arguments to path.join must be strings");m&&(i+=i?"/"+m:m)}return A.normalize(i)},A.relative=function(i,c){i=A.resolve(i).substr(1),c=A.resolve(c).substr(1);for(var m=b(i.split("/")),g=b(c.split("/")),W=Math.min(m.length,g.length),rt=W,it=0;it<W;it++)if(m[it]!==g[it]){rt=it;break}var dt=[];for(it=rt;it<m.length;it++)dt.push("..");return(dt=dt.concat(g.slice(rt))).join("/")},A._makeLong=function(i){return i},A.dirname=function(i){var c=L(i),m=c[0],g=c[1];return m||g?(g&&(g=g.substr(0,g.length-1)),m+g):"."},A.basename=function(i,c){var m=L(i)[2];return c&&m.substr(-1*c.length)===c&&(m=m.substr(0,m.length-c.length)),m},A.extname=function(i){return L(i)[3]},A.format=function(i){if(!R.isObject(i))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof i);var c=i.root||"";if(!R.isString(c))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof i.root);return(i.dir?i.dir+A.sep:"")+(i.base||"")},A.parse=function(i){if(!R.isString(i))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof i);var c=L(i);if(!c||c.length!==4)throw new TypeError("Invalid path '"+i+"'");return c[1]=c[1]||"",c[2]=c[2]||"",c[3]=c[3]||"",{root:c[0],dir:c[0]+c[1].slice(0,-1),base:c[2],ext:c[3],name:c[2].slice(0,c[2].length-c[3].length)}},A.sep="/",A.delimiter=":",U.exports=k?u:A,U.exports.posix=A,U.exports.win32=u},155:U=>{var f,E,j=U.exports={};function k(){throw new Error("setTimeout has not been defined")}function R(){throw new Error("clearTimeout has not been defined")}function Y(A){if(f===setTimeout)return setTimeout(A,0);if((f===k||!f)&&setTimeout)return f=setTimeout,setTimeout(A,0);try{return f(A,0)}catch{try{return f.call(null,A,0)}catch{return f.call(this,A,0)}}}(function(){try{f=typeof setTimeout=="function"?setTimeout:k}catch{f=k}try{E=typeof clearTimeout=="function"?clearTimeout:R}catch{E=R}})();var b,d=[],x=!1,u=-1;function S(){x&&b&&(x=!1,b.length?d=b.concat(d):u=-1,d.length&&y())}function y(){if(!x){var A=Y(S);x=!0;for(var L=d.length;L;){for(b=d,d=[];++u<L;)b&&b[u].run();u=-1,L=d.length}b=null,x=!1,(function(i){if(E===clearTimeout)return clearTimeout(i);if((E===R||!E)&&clearTimeout)return E=clearTimeout,clearTimeout(i);try{E(i)}catch{try{return E.call(null,i)}catch{return E.call(this,i)}}})(A)}}function O(A,L){this.fun=A,this.array=L}function D(){}j.nextTick=function(A){var L=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)L[i-1]=arguments[i];d.push(new O(A,L)),d.length!==1||x||Y(y)},O.prototype.run=function(){this.fun.apply(null,this.array)},j.title="browser",j.browser=!0,j.env={},j.argv=[],j.version="",j.versions={},j.on=D,j.addListener=D,j.once=D,j.off=D,j.removeListener=D,j.removeAllListeners=D,j.emit=D,j.prependListener=D,j.prependOnceListener=D,j.listeners=function(A){return[]},j.binding=function(A){throw new Error("process.binding is not supported")},j.cwd=function(){return"/"},j.chdir=function(A){throw new Error("process.chdir is not supported")},j.umask=function(){return 0}},384:U=>{U.exports=function(f){return f&&typeof f=="object"&&typeof f.copy=="function"&&typeof f.fill=="function"&&typeof f.readUInt8=="function"}},539:(U,f,E)=>{var j=E(155),k=/%[sdj%]/g;f.format=function(p){if(!i(p)){for(var T=[],I=0;I<arguments.length;I++)T.push(b(arguments[I]));return T.join(" ")}I=1;for(var ct=arguments,Ot=ct.length,Z=String(p).replace(k,(function(F){if(F==="%%")return"%";if(I>=Ot)return F;switch(F){case"%s":return String(ct[I++]);case"%d":return Number(ct[I++]);case"%j":try{return JSON.stringify(ct[I++])}catch{return"[Circular]"}default:return F}})),tt=ct[I];I<Ot;tt=ct[++I])A(tt)||!g(tt)?Z+=" "+tt:Z+=" "+b(tt);return Z},f.deprecate=function(p,T){if(c(E.g.process))return function(){return f.deprecate(p,T).apply(this,arguments)};if(j.noDeprecation===!0)return p;var I=!1;return function(){if(!I){if(j.throwDeprecation)throw new Error(T);j.traceDeprecation?console.trace(T):console.error(T),I=!0}return p.apply(this,arguments)}};var R,Y={};function b(p,T){var I={seen:[],stylize:x};return arguments.length>=3&&(I.depth=arguments[2]),arguments.length>=4&&(I.colors=arguments[3]),D(T)?I.showHidden=T:T&&f._extend(I,T),c(I.showHidden)&&(I.showHidden=!1),c(I.depth)&&(I.depth=2),c(I.colors)&&(I.colors=!1),c(I.customInspect)&&(I.customInspect=!0),I.colors&&(I.stylize=d),u(I,p,I.depth)}function d(p,T){var I=b.styles[T];return I?"\x1B["+b.colors[I][0]+"m"+p+"\x1B["+b.colors[I][1]+"m":p}function x(p,T){return p}function u(p,T,I){if(p.customInspect&&T&&it(T.inspect)&&T.inspect!==f.inspect&&(!T.constructor||T.constructor.prototype!==T)){var ct=T.inspect(I,p);return i(ct)||(ct=u(p,ct,I)),ct}var Ot=(function(ut,at){if(c(at))return ut.stylize("undefined","undefined");if(i(at)){var At="'"+JSON.stringify(at).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return ut.stylize(At,"string")}if(L(at))return ut.stylize(""+at,"number");if(D(at))return ut.stylize(""+at,"boolean");if(A(at))return ut.stylize("null","null")})(p,T);if(Ot)return Ot;var Z=Object.keys(T),tt=(function(ut){var at={};return ut.forEach((function(At,Ft){at[At]=!0})),at})(Z);if(p.showHidden&&(Z=Object.getOwnPropertyNames(T)),rt(T)&&(Z.indexOf("message")>=0||Z.indexOf("description")>=0))return S(T);if(Z.length===0){if(it(T)){var F=T.name?": "+T.name:"";return p.stylize("[Function"+F+"]","special")}if(m(T))return p.stylize(RegExp.prototype.toString.call(T),"regexp");if(W(T))return p.stylize(Date.prototype.toString.call(T),"date");if(rt(T))return S(T)}var mt,Ct="",Rt=!1,Jt=["{","}"];return O(T)&&(Rt=!0,Jt=["[","]"]),it(T)&&(Ct=" [Function"+(T.name?": "+T.name:"")+"]"),m(T)&&(Ct=" "+RegExp.prototype.toString.call(T)),W(T)&&(Ct=" "+Date.prototype.toUTCString.call(T)),rt(T)&&(Ct=" "+S(T)),Z.length!==0||Rt&&T.length!=0?I<0?m(T)?p.stylize(RegExp.prototype.toString.call(T),"regexp"):p.stylize("[Object]","special"):(p.seen.push(T),mt=Rt?(function(ut,at,At,Ft,Gt){for(var te=[],Ut=0,Lt=at.length;Ut<Lt;++Ut)Mt(at,String(Ut))?te.push(y(ut,at,At,Ft,String(Ut),!0)):te.push("");return Gt.forEach((function(Vt){Vt.match(/^\d+$/)||te.push(y(ut,at,At,Ft,Vt,!0))})),te})(p,T,I,tt,Z):Z.map((function(ut){return y(p,T,I,tt,ut,Rt)})),p.seen.pop(),(function(ut,at,At){return ut.reduce((function(Ft,Gt){return Gt.indexOf(`
`)>=0,Ft+Gt.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?At[0]+(at===""?"":at+`
 `)+" "+ut.join(`,
  `)+" "+At[1]:At[0]+at+" "+ut.join(", ")+" "+At[1]})(mt,Ct,Jt)):Jt[0]+Ct+Jt[1]}function S(p){return"["+Error.prototype.toString.call(p)+"]"}function y(p,T,I,ct,Ot,Z){var tt,F,mt;if((mt=Object.getOwnPropertyDescriptor(T,Ot)||{value:T[Ot]}).get?F=mt.set?p.stylize("[Getter/Setter]","special"):p.stylize("[Getter]","special"):mt.set&&(F=p.stylize("[Setter]","special")),Mt(ct,Ot)||(tt="["+Ot+"]"),F||(p.seen.indexOf(mt.value)<0?(F=A(I)?u(p,mt.value,null):u(p,mt.value,I-1)).indexOf(`
`)>-1&&(F=Z?F.split(`
`).map((function(Ct){return"  "+Ct})).join(`
`).substr(2):`
`+F.split(`
`).map((function(Ct){return"   "+Ct})).join(`
`)):F=p.stylize("[Circular]","special")),c(tt)){if(Z&&Ot.match(/^\d+$/))return F;(tt=JSON.stringify(""+Ot)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(tt=tt.substr(1,tt.length-2),tt=p.stylize(tt,"name")):(tt=tt.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),tt=p.stylize(tt,"string"))}return tt+": "+F}function O(p){return Array.isArray(p)}function D(p){return typeof p=="boolean"}function A(p){return p===null}function L(p){return typeof p=="number"}function i(p){return typeof p=="string"}function c(p){return p===void 0}function m(p){return g(p)&&dt(p)==="[object RegExp]"}function g(p){return typeof p=="object"&&p!==null}function W(p){return g(p)&&dt(p)==="[object Date]"}function rt(p){return g(p)&&(dt(p)==="[object Error]"||p instanceof Error)}function it(p){return typeof p=="function"}function dt(p){return Object.prototype.toString.call(p)}function jt(p){return p<10?"0"+p.toString(10):p.toString(10)}f.debuglog=function(p){if(c(R)&&(R=j.env.NODE_DEBUG||""),p=p.toUpperCase(),!Y[p])if(new RegExp("\\b"+p+"\\b","i").test(R)){var T=j.pid;Y[p]=function(){var I=f.format.apply(f,arguments);console.error("%s %d: %s",p,T,I)}}else Y[p]=function(){};return Y[p]},f.inspect=b,b.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},b.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},f.isArray=O,f.isBoolean=D,f.isNull=A,f.isNullOrUndefined=function(p){return p==null},f.isNumber=L,f.isString=i,f.isSymbol=function(p){return typeof p=="symbol"},f.isUndefined=c,f.isRegExp=m,f.isObject=g,f.isDate=W,f.isError=rt,f.isFunction=it,f.isPrimitive=function(p){return p===null||typeof p=="boolean"||typeof p=="number"||typeof p=="string"||typeof p=="symbol"||p===void 0},f.isBuffer=E(384);var St=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Pt(){var p=new Date,T=[jt(p.getHours()),jt(p.getMinutes()),jt(p.getSeconds())].join(":");return[p.getDate(),St[p.getMonth()],T].join(" ")}function Mt(p,T){return Object.prototype.hasOwnProperty.call(p,T)}f.log=function(){console.log("%s - %s",Pt(),f.format.apply(f,arguments))},f.inherits=E(717),f._extend=function(p,T){if(!T||!g(T))return p;for(var I=Object.keys(T),ct=I.length;ct--;)p[I[ct]]=T[I[ct]];return p}}},lt={};function $(U){var f=lt[U];if(f!==void 0)return f.exports;var E=lt[U]={exports:{}};return et[U].call(E.exports,E,E.exports,$),E.exports}$.n=U=>{var f=U&&U.__esModule?()=>U.default:()=>U;return $.d(f,{a:f}),f},$.d=(U,f)=>{for(var E in f)$.o(f,E)&&!$.o(U,E)&&Object.defineProperty(U,E,{enumerable:!0,get:f[E]})},$.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),$.o=(U,f)=>Object.prototype.hasOwnProperty.call(U,f),$.r=U=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(U,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(U,"__esModule",{value:!0})};var G={};return(()=>{$.r(G),$.d(G,{LSPluginUser:()=>pn,setupPluginUserInstance:()=>Rn});var U=$(520),f=($(856),$(996)),E=$.n(f),j=function(){return j=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e},j.apply(this,arguments)};function k(e){return e.toLowerCase()}var R=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],Y=/[^A-Z0-9]+/gi;function b(e,t,r){return t instanceof RegExp?e.replace(t,r):t.reduce((function(n,s){return n.replace(s,r)}),e)}function d(e,t){return t===void 0&&(t={}),(function(r,n){n===void 0&&(n={});for(var s=n.splitRegexp,a=s===void 0?R:s,l=n.stripRegexp,h=l===void 0?Y:l,C=n.transform,N=C===void 0?k:C,z=n.delimiter,P=z===void 0?" ":z,H=b(b(r,a,"$1\0$2"),h,"\0"),Q=0,V=H.length;H.charAt(Q)==="\0";)Q++;for(;H.charAt(V-1)==="\0";)V--;return H.slice(Q,V).split("\0").map(N).join(P)})(e,j({delimiter:"."},t))}var x=$(729),u=$.n(x);function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const y=navigator.platform.toLowerCase()==="win32"?U.win32:U.posix,O=function(e,t){return t===void 0&&(t={}),d(e,j({delimiter:"_"},t))};class D extends u(){constructor(t,r){super(),S(this,"_tag",void 0),S(this,"_opts",void 0),S(this,"_logs",[]),this._tag=t,this._opts=r}write(t,r,n){var s;r!=null&&r.length&&r[r.length-1]===!0&&(n=!0,r.pop());const a=r.reduce(((h,C)=>(C&&C instanceof Error?h+=`${C.message} ${C.stack}`:h+=C.toString(),h)),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var l;this._logs.push([t,a]),(n||(s=this._opts)!==null&&s!==void 0&&s.console)&&((l=console)===null||l===void 0||l[t==="ERROR"?"error":"debug"](`${t}: ${a}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...t){this.write("INFO",t)}error(...t){this.write("ERROR",t)}warn(...t){this.write("WARN",t)}setTag(t){this._tag=t}toJSON(){return this._logs}}function A(e,...t){try{const r=new URL(e);if(!r.origin)throw new Error(null);const n=y.join(e.substr(r.origin.length),...t);return r.origin+n}catch{return y.join(e,...t)}}function L(e,t){let r,n,s=!1;const a=h=>C=>{e&&clearTimeout(e),h(C),s=!0},l=new Promise(((h,C)=>{r=a(h),n=a(C),e&&(e=setTimeout((()=>n(new Error(`[deferred timeout] ${t}`))),e))}));return{created:Date.now(),setTag:h=>t=h,resolve:r,reject:n,promise:l,get settled(){return s}}}const i=new Map;window.__injectedUIEffects=i;var c=$(227),m=$.n(c);function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const W="application/x-postmate-v1+json";let rt=0;const it={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},dt=(e,t)=>(typeof t!="string"||e.origin===t)&&!!e.data&&(typeof e.data!="object"||"postmate"in e.data)&&e.data.type===W&&!!it[e.data.postmate];class jt{constructor(t){g(this,"parent",void 0),g(this,"frame",void 0),g(this,"child",void 0),g(this,"events",{}),g(this,"childOrigin",void 0),g(this,"listener",void 0),this.parent=t.parent,this.frame=t.frame,this.child=t.child,this.childOrigin=t.childOrigin,this.listener=r=>{if(!dt(r,this.childOrigin))return!1;const{data:n,name:s}=((r||{}).data||{}).value||{};r.data.postmate==="emit"&&s in this.events&&this.events[s].forEach((a=>{a.call(this,n)}))},this.parent.addEventListener("message",this.listener,!1)}get(t,...r){return new Promise(((n,s)=>{const a=++rt,l=h=>{h.data.uid===a&&h.data.postmate==="reply"&&(this.parent.removeEventListener("message",l,!1),h.data.error?s(h.data.error):n(h.data.value))};this.parent.addEventListener("message",l,!1),this.child.postMessage({postmate:"request",type:W,property:t,args:r,uid:a},this.childOrigin)}))}call(t,r){this.child.postMessage({postmate:"call",type:W,property:t,data:r},this.childOrigin)}on(t,r){this.events[t]||(this.events[t]=[]),this.events[t].push(r)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class St{constructor(t){g(this,"model",void 0),g(this,"parent",void 0),g(this,"parentOrigin",void 0),g(this,"child",void 0),this.model=t.model,this.parent=t.parent,this.parentOrigin=t.parentOrigin,this.child=t.child,this.child.addEventListener("message",(r=>{if(!dt(r,this.parentOrigin))return;const{property:n,uid:s,data:a,args:l}=r.data;r.data.postmate!=="call"?((h,C,N)=>{const z=typeof h[C]=="function"?h[C].apply(null,N):h[C];return Promise.resolve(z)})(this.model,n,l).then((h=>{r.source.postMessage({property:n,postmate:"reply",type:W,uid:s,value:h},r.origin)})).catch((h=>{r.source.postMessage({property:n,postmate:"reply",type:W,uid:s,error:h},r.origin)})):n in this.model&&typeof this.model[n]=="function"&&this.model[n](a)}))}emit(t,r){this.parent.postMessage({postmate:"emit",type:W,value:{name:t,data:r}},this.parentOrigin)}}class Pt{constructor(t){g(this,"container",void 0),g(this,"parent",void 0),g(this,"frame",void 0),g(this,"child",void 0),g(this,"childOrigin",void 0),g(this,"url",void 0),g(this,"model",void 0),this.container=t.container,this.url=t.url,this.parent=window,this.frame=document.createElement("iframe"),t.id&&(this.frame.id=t.id),t.name&&(this.frame.name=t.name),this.frame.classList.add.apply(this.frame.classList,t.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=t.model||{}}sendHandshake(t){const r=(a=>{const l=document.createElement("a");l.href=a;const h=l.protocol.length>4?l.protocol:window.location.protocol,C=l.host.length?l.port==="80"||l.port==="443"?l.hostname:l.host:window.location.host;return l.origin||`${h}//${C}`})(t=t||this.url);let n,s=0;return new Promise(((a,l)=>{const h=N=>!!dt(N,r)&&(N.data.postmate==="handshake-reply"?(clearInterval(n),this.parent.removeEventListener("message",h,!1),this.childOrigin=N.origin,a(new jt(this))):l("Failed handshake"));this.parent.addEventListener("message",h,!1);const C=()=>{s++,this.child.postMessage({postmate:"handshake",type:W,model:this.model},r),s===5&&clearInterval(n)};this.frame.addEventListener("load",(()=>{C(),n=setInterval(C,500)})),this.frame.src=t}))}destroy(){this.frame.parentNode.removeChild(this.frame)}}g(Pt,"debug",!1),g(Pt,"Model",void 0);class Mt{constructor(t){g(this,"child",void 0),g(this,"model",void 0),g(this,"parent",void 0),g(this,"parentOrigin",void 0),this.child=window,this.model=t,this.parent=this.child.parent}sendHandshakeReply(){return new Promise(((t,r)=>{const n=s=>{if(s.data.postmate){if(s.data.postmate==="handshake"){this.child.removeEventListener("message",n,!1),s.source.postMessage({postmate:"handshake-reply",type:W},s.origin),this.parentOrigin=s.origin;const a=s.data.model;return a&&Object.keys(a).forEach((l=>{this.model[l]=a[l]})),t(new St(this))}return r("Handshake Reply Failed")}};this.child.addEventListener("message",n,!1)}))}}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const{importHTML:T,createSandboxContainer:I}=window.QSandbox||{};function ct(e,t){return e.startsWith("http")?fetch(e,t):(e=e.replace("file://",""),new Promise((async(r,n)=>{try{const s=await window.apis.doAction(["readFile",e]);r({text:()=>s})}catch(s){console.error(s),n(s)}})))}class Ot extends u(){constructor(t){super(),p(this,"_pluginLocal",void 0),p(this,"_frame",void 0),p(this,"_root",void 0),p(this,"_loaded",!1),p(this,"_unmountFns",[]),this._pluginLocal=t,t._dispose((()=>{this._unmount()}))}async load(){const{name:t,entry:r}=this._pluginLocal.options;if(this.loaded||!r)return;const{template:n,execScripts:s}=await T(r,{fetch:ct});this._mount(n,document.body);const a=I(t,{elementGetter:()=>{var h;return(h=this._root)===null||h===void 0?void 0:h.firstChild}}).instance.proxy;a.__shadow_mode__=!0,a.LSPluginLocal=this._pluginLocal,a.LSPluginShadow=this,a.LSPluginUser=a.logseq=new pn(this._pluginLocal.toJSON(),this._pluginLocal.caller);const l=await s(a,!0);this._unmountFns.push(l.unmount),this._loaded=!0}_mount(t,r){const n=this._frame=document.createElement("div");n.classList.add("lsp-shadow-sandbox"),n.id=this._pluginLocal.id,this._root=n.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${t}</div>`,r.appendChild(n),this.emit("mounted")}_unmount(){for(const t of this._unmountFns)t&&t.call(null)}destroy(){var t,r;(t=this.frame)===null||t===void 0||(r=t.parentNode)===null||r===void 0||r.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var t;return(t=this._root)===null||t===void 0?void 0:t.firstChild}get frame(){return this._frame}}function Z(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const tt=m()("LSPlugin:caller"),F="#await#response#",mt="#lspmsg#",Ct="#lspmsg#error#",Rt=e=>`#lspmsg#${e}`;class Jt extends u(){constructor(t){super(),Z(this,"_pluginLocal",void 0),Z(this,"_connected",!1),Z(this,"_parent",void 0),Z(this,"_child",void 0),Z(this,"_shadow",void 0),Z(this,"_status",void 0),Z(this,"_userModel",{}),Z(this,"_call",void 0),Z(this,"_callUserModel",void 0),Z(this,"_debugTag",""),this._pluginLocal=t,t&&(this._debugTag=t.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:t}=this._pluginLocal;t?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(t={}){if(this._connected)return;const r=this,n=this._pluginLocal!=null;let s=0;const a=new Map,l=L(6e4),h=this._extendUserModel({"#lspmsg#ready#":async z=>{h[Rt(z?.pid)]=({type:P,payload:H})=>{tt(`[host (_call) -> *user] ${this._debugTag}`,P,H),r.emit(P,H)},await l.resolve()},"#lspmsg#beforeunload#":async z=>{const P=L(1e4);r.emit("beforeunload",Object.assign({actor:P},z)),await P.promise},"#lspmsg#settings#":async({type:z,payload:P})=>{r.emit("settings:changed",P)},[mt]:async({ns:z,type:P,payload:H})=>{tt(`[host (async) -> *user] ${this._debugTag} ns=${z} type=${P}`,H),z&&z.startsWith("hook")?r.emit(`${z}:${P}`,H):r.emit(P,H)},"#lspmsg#reply#":({_sync:z,result:P})=>{if(tt(`[sync host -> *user] #${z}`,P),a.has(z)){const H=a.get(z);H&&(P!=null&&P.hasOwnProperty(Ct)?H.reject(P[Ct]):H.resolve(P),a.delete(z))}},...t});var C;if(n)return await l.promise,JSON.parse(JSON.stringify((C=this._pluginLocal)===null||C===void 0?void 0:C.toJSON()));const N=new Mt(h).sendHandshakeReply();return this._status="pending",await N.then((z=>{this._child=z,this._connected=!0,this._call=async(P,H={},Q)=>{if(Q){const V=++s;a.set(V,Q),H._sync=V,Q.setTag(`async call #${V}`),tt(`async call #${V}`)}return z.emit(Rt(h.baseInfo.id),{type:P,payload:H}),Q?.promise},this._callUserModel=async(P,H)=>{try{h[P](H)}catch{tt(`[model method] #${P} not existed`)}},setInterval((()=>{if(a.size>100)for(const[P,H]of a)H.settled&&a.delete(P)}),18e5)})).finally((()=>{this._status=void 0})),await l.promise,h.baseInfo}async call(t,r={}){var n;return(n=this._call)===null||n===void 0?void 0:n.call(this,t,r)}async callAsync(t,r={}){var n;const s=L(1e4);return(n=this._call)===null||n===void 0?void 0:n.call(this,t,r,s)}async callUserModel(t,...r){var n;return(n=this._callUserModel)===null||n===void 0?void 0:n.apply(this,[t,...r])}async callUserModelAsync(t,...r){var n;return t=`${F}${t}`,(n=this._callUserModel)===null||n===void 0?void 0:n.apply(this,[t,...r])}async _setupIframeSandbox(){const t=this._pluginLocal,r=t.id,n=`${r}_lsp_main`,s=new URL(t.options.entry);s.searchParams.set("__v__",t.options.version);const a=document.querySelector(`#${n}`);a&&a.parentElement.removeChild(a);const l=document.createElement("div");l.classList.add("lsp-iframe-sandbox-container"),l.id=n,l.dataset.pid=r;try{var h;const P=(h=await this._pluginLocal._loadLayoutsData())===null||h===void 0?void 0:h.$$0;if(P){l.dataset.inited_layout="true";let{width:H,height:Q,left:V,top:ot,vw:st,vh:_t}=P;V=Math.max(V,0),V=typeof st=="number"?`${Math.min(100*V/st,99)}%`:`${V}px`,ot=Math.max(ot,45),ot=typeof _t=="number"?`${Math.min(100*ot/_t,99)}%`:`${ot}px`,Object.assign(l.style,{width:H+"px",height:Q+"px",left:V,top:ot})}}catch(P){console.error("[Restore Layout Error]",P)}document.body.appendChild(l);const C=new Pt({id:r+"_iframe",container:l,url:s.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(t.toJSON()))}});let N,z=C.sendHandshake();return this._status="pending",new Promise(((P,H)=>{N=setTimeout((()=>{H(new Error("handshake Timeout")),C.destroy()}),8e3),z.then((Q=>{this._parent=Q,this._connected=!0,this.emit("connected"),Q.on(Rt(t.id),(({type:V,payload:ot})=>{var st,_t;tt("[user -> *host] ",V,ot),(st=this._pluginLocal)===null||st===void 0||st.emit(V,ot||{}),(_t=this._pluginLocal)===null||_t===void 0||_t.caller.emit(V,ot||{})})),this._call=async(...V)=>{Q.call(Rt(t.id),{type:V[0],payload:Object.assign(V[1]||{},{$$pid:t.id})})},this._callUserModel=async(V,...ot)=>{if(V.startsWith(F))return await Q.get(V.replace(F,""),...ot);Q.call(V,ot?.[0])},P(null)})).catch((Q=>{H(Q)})).finally((()=>{clearTimeout(N)}))})).catch((P=>{throw tt("[iframe sandbox] error",P),P})).finally((()=>{this._status=void 0}))}async _setupShadowSandbox(){const t=this._pluginLocal,r=this._shadow=new Ot(t);try{this._status="pending",await r.load(),this._connected=!0,this.emit("connected"),this._call=async(n,s={},a)=>{var l;return a&&(s.actor=a),(l=this._pluginLocal)===null||l===void 0||l.emit(n,Object.assign(s,{$$pid:t.id})),a?.promise},this._callUserModel=async(...n)=>{var s;let a=n[0];(s=a)!==null&&s!==void 0&&s.startsWith(F)&&(a=a.replace(F,""));const l=n[1]||{},h=this._userModel[a];typeof h=="function"&&await h.call(null,l)}}catch(n){throw tt("[shadow sandbox] error",n),n}finally{this._status=void 0}}_extendUserModel(t){return Object.assign(this._userModel,t)}_getSandboxIframeContainer(){var t;return(t=this._parent)===null||t===void 0?void 0:t.frame.parentNode}_getSandboxShadowContainer(){var t;return(t=this._shadow)===null||t===void 0?void 0:t.frame.parentNode}_getSandboxIframeRoot(){var t;return(t=this._parent)===null||t===void 0?void 0:t.frame}_getSandboxShadowRoot(){var t;return(t=this._shadow)===null||t===void 0?void 0:t.frame}set debugTag(t){this._debugTag=t}async destroy(){var t;let r=null;this._parent&&(r=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(r=this._getSandboxShadowContainer(),this._shadow.destroy()),(t=r)===null||t===void 0||t.parentNode.removeChild(r)}}function ut(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class at{constructor(t,r){ut(this,"ctx",void 0),ut(this,"opts",void 0),this.ctx=t,this.opts=r}get ctxId(){return this.ctx.baseInfo.id}setItem(t,r){var n;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,t,r,(n=this.opts)===null||n===void 0?void 0:n.assets]})}getItem(t){var r;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,t,(r=this.opts)===null||r===void 0?void 0:r.assets]})}removeItem(t){var r;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,t,(r=this.opts)===null||r===void 0?void 0:r.assets]})}allKeys(){var t;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(t=this.opts)===null||t===void 0?void 0:t.assets]})}clear(){var t;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(t=this.opts)===null||t===void 0?void 0:t.assets]})}hasItem(t){var r;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,t,(r=this.opts)===null||r===void 0?void 0:r.assets]})}}class At{constructor(t){var r,n,s;s=void 0,(n="ctx")in(r=this)?Object.defineProperty(r,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[n]=s,this.ctx=t}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get Components(){return{Editor:this.ensureHostScope().logseq.sdk.experiments.cp_page_editor}}get Utils(){const t=this.ensureHostScope().logseq.sdk.utils,r=n=>t[O(n)];return{toClj:r("toClj"),jsxToClj:r("jsxToClj"),toJs:r("toJs"),toKeyword:r("toKeyword"),toSymbol:r("toSymbol")}}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(t,...r){var n;const s=this.ensureHostScope();t=(n=O(t))===null||n===void 0?void 0:n.toLowerCase();const a=s.logseq.api["exper_"+t]||s.logseq.sdk.experiments[t];return a?.apply(s,r)}async loadScripts(...t){(t=t.map((r=>r!=null&&r.startsWith("http")?r:this.ctx.resolveResourceFullUrl(r)))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...t)}registerFencedCodeRenderer(t,r){return this.invokeExperMethod("registerFencedCodeRenderer",this.ctx.baseInfo.id,t,r)}registerDaemonRenderer(t,r){return this.invokeExperMethod("registerDaemonRenderer",this.ctx.baseInfo.id,t,r)}registerRouteRenderer(t,r){return this.invokeExperMethod("registerRouteRenderer",this.ctx.baseInfo.id,t,r)}registerExtensionsEnhancer(t,r){const n=this.ensureHostScope();return t==="katex"&&n.katex&&r(n.katex).catch(console.error),this.invokeExperMethod("registerExtensionsEnhancer",this.ctx.baseInfo.id,t,r)}ensureHostScope(){try{var t;(t=window.top)===null||t===void 0||t.document}catch{console.error("Can not access host scope!")}return window.top}}function Ft(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Gt=e=>`task_callback_${e}`;class te{constructor(t,r,n={}){Ft(this,"_client",void 0),Ft(this,"_requestId",void 0),Ft(this,"_requestOptions",void 0),Ft(this,"_promise",void 0),Ft(this,"_aborted",!1),this._client=t,this._requestId=r,this._requestOptions=n,this._promise=new Promise(((h,C)=>{if(!this._requestId)return C(null);this._client.once(Gt(this._requestId),(N=>{N&&N instanceof Error?C(N):h(N)}))}));const{success:s,fail:a,final:l}=this._requestOptions;this._promise.then((h=>{s?.(h)})).catch((h=>{a?.(h)})).finally((()=>{l?.()}))}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class Ut extends x.EventEmitter{constructor(t){super(),Ft(this,"_ctx",void 0),this._ctx=t,this.ctx.caller.on("#lsp#request#callback",(r=>{const n=r?.requestId;n&&this.emit(Gt(n),r?.payload)}))}static createRequestTask(t,r,n){return new te(t,r,n)}async _request(t){const r=this.ctx.baseInfo.id,{success:n,fail:s,final:a,...l}=t,h=this.ctx.Experiments.invokeExperMethod("request",r,l),C=Ut.createRequestTask(this.ctx.Request,h,t);return l.abortable?C:C.promise}get ctx(){return this._ctx}}const Lt=Array.isArray,Vt=typeof zr=="object"&&zr&&zr.Object===Object&&zr;var qr=typeof self=="object"&&self&&self.Object===Object&&self;const $t=Vt||qr||Function("return this")(),Zt=$t.Symbol;var fr=Object.prototype,Br=fr.hasOwnProperty,Hr=fr.toString,be=Zt?Zt.toStringTag:void 0;const Wr=function(e){var t=Br.call(e,be),r=e[be];try{e[be]=void 0;var n=!0}catch{}var s=Hr.call(e);return n&&(t?e[be]=r:delete e[be]),s};var Jr=Object.prototype.toString;const Gr=function(e){return Jr.call(e)};var pr=Zt?Zt.toStringTag:void 0;const ie=function(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":pr&&pr in Object(e)?Wr(e):Gr(e)},Ie=function(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")},w=function(e){if(!Ie(e))return!1;var t=ie(e);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},M=$t["__core-js_shared__"];var B,X=(B=/[^.]+$/.exec(M&&M.keys&&M.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"";const gt=function(e){return!!X&&X in e};var Tt=Function.prototype.toString;const wt=function(e){if(e!=null){try{return Tt.call(e)}catch{}try{return e+""}catch{}}return""};var _e=/^\[object .+?Constructor\]$/,we=Function.prototype,dr=Object.prototype,Vr=we.toString,Zr=dr.hasOwnProperty,Kr=RegExp("^"+Vr.call(Zr).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Me=function(e){return!(!Ie(e)||gt(e))&&(w(e)?Kr:_e).test(wt(e))},Le=function(e,t){return e?.[t]},ee=function(e,t){var r=Le(e,t);return Me(r)?r:void 0},hr=(function(){try{var e=ee(Object,"defineProperty");return e({},"",{}),e}catch{}})(),Yr=function(e,t,r){t=="__proto__"&&hr?hr(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},xe=(function(e){return function(t,r,n){for(var s=-1,a=Object(t),l=n(t),h=l.length;h--;){var C=l[++s];if(r(a[C],C,a)===!1)break}return t}})(),Ve=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},kt=function(e){return e!=null&&typeof e=="object"},Fe=function(e){return kt(e)&&ie(e)=="[object Arguments]"};var Se=Object.prototype,Ze=Se.hasOwnProperty,Xr=Se.propertyIsEnumerable;const mr=Fe((function(){return arguments})())?Fe:function(e){return kt(e)&&Ze.call(e,"callee")&&!Xr.call(e,"callee")},Qr=function(){return!1};var gr=K&&!K.nodeType&&K,Ke=gr&&!0&&q&&!q.nodeType&&q,Nt=Ke&&Ke.exports===gr?$t.Buffer:void 0;const Kt=(Nt?Nt.isBuffer:void 0)||Qr;var yt=/^(?:0|[1-9]\d*)$/;const Ne=function(e,t){var r=typeof e;return!!(t=t??9007199254740991)&&(r=="number"||r!="symbol"&&yt.test(e))&&e>-1&&e%1==0&&e<t},Ce=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991};var nt={};nt["[object Float32Array]"]=nt["[object Float64Array]"]=nt["[object Int8Array]"]=nt["[object Int16Array]"]=nt["[object Int32Array]"]=nt["[object Uint8Array]"]=nt["[object Uint8ClampedArray]"]=nt["[object Uint16Array]"]=nt["[object Uint32Array]"]=!0,nt["[object Arguments]"]=nt["[object Array]"]=nt["[object ArrayBuffer]"]=nt["[object Boolean]"]=nt["[object DataView]"]=nt["[object Date]"]=nt["[object Error]"]=nt["[object Function]"]=nt["[object Map]"]=nt["[object Number]"]=nt["[object Object]"]=nt["[object RegExp]"]=nt["[object Set]"]=nt["[object String]"]=nt["[object WeakMap]"]=!1;const tn=function(e){return kt(e)&&Ce(e.length)&&!!nt[ie(e)]},en=function(e){return function(t){return e(t)}};var yr=K&&!K.nodeType&&K,se=yr&&!0&&q&&!q.nodeType&&q,Ye=se&&se.exports===yr&&Vt.process,Pe=(function(){try{var e=se&&se.require&&se.require("util").types;return e||Ye&&Ye.binding&&Ye.binding("util")}catch{}})(),ht=Pe&&Pe.isTypedArray;const Xe=ht?en(ht):tn;var vt=Object.prototype.hasOwnProperty;const vr=function(e,t){var r=Lt(e),n=!r&&mr(e),s=!r&&!n&&Kt(e),a=!r&&!n&&!s&&Xe(e),l=r||n||s||a,h=l?Ve(e.length,String):[],C=h.length;for(var N in e)!vt.call(e,N)||l&&(N=="length"||s&&(N=="offset"||N=="parent")||a&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||Ne(N,C))||h.push(N);return h};var ft=Object.prototype;const ke=function(e){var t=e&&e.constructor;return e===(typeof t=="function"&&t.prototype||ft)},Qe=(function(e,t){return function(r){return e(t(r))}})(Object.keys,Object);var br=Object.prototype.hasOwnProperty;const tr=function(e){if(!ke(e))return Qe(e);var t=[];for(var r in Object(e))br.call(e,r)&&r!="constructor"&&t.push(r);return t},_r=function(e){return e!=null&&Ce(e.length)&&!w(e)},Re=function(e){return _r(e)?vr(e):tr(e)},ae=function(e,t){return e&&xe(e,t,Re)},er=function(){this.__data__=[],this.size=0},Yt=function(e,t){return e===t||e!=e&&t!=t},le=function(e,t){for(var r=e.length;r--;)if(Yt(e[r][0],t))return r;return-1};var rr=Array.prototype.splice;const ce=function(e){var t=this.__data__,r=le(t,e);return!(r<0)&&(r==t.length-1?t.pop():rr.call(t,r,1),--this.size,!0)},Ue=function(e){var t=this.__data__,r=le(t,e);return r<0?void 0:t[r][1]},De=function(e){return le(this.__data__,e)>-1},wr=function(e,t){var r=this.__data__,n=le(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function re(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}re.prototype.clear=er,re.prototype.delete=ce,re.prototype.get=Ue,re.prototype.has=De,re.prototype.set=wr;const ze=re,nr=function(){this.__data__=new ze,this.size=0},Ee=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},ue=function(e){return this.__data__.get(e)},fe=function(e){return this.__data__.has(e)},pe=ee($t,"Map"),de=ee(Object,"create"),xr=function(){this.__data__=de?de(null):{},this.size=0},or=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t};var Sr=Object.prototype.hasOwnProperty;const $e=function(e){var t=this.__data__;if(de){var r=t[e];return r==="__lodash_hash_undefined__"?void 0:r}return Sr.call(t,e)?t[e]:void 0};var qe=Object.prototype.hasOwnProperty;const qt=function(e){var t=this.__data__;return de?t[e]!==void 0:qe.call(t,e)},he=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=de&&t===void 0?"__lodash_hash_undefined__":t,this};function ne(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ne.prototype.clear=xr,ne.prototype.delete=or,ne.prototype.get=$e,ne.prototype.has=qt,ne.prototype.set=he;const Be=ne,rn=function(){this.size=0,this.__data__={hash:new Be,map:new(pe||ze),string:new Be}},nn=function(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null},He=function(e,t){var r=e.__data__;return nn(t)?r[typeof t=="string"?"string":"hash"]:r.map},me=function(e){var t=He(this,e).delete(e);return this.size-=t?1:0,t},Cr=function(e){return He(this,e).get(e)},on=function(e){return He(this,e).has(e)},kr=function(e,t){var r=He(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Xt(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Xt.prototype.clear=rn,Xt.prototype.delete=me,Xt.prototype.get=Cr,Xt.prototype.has=on,Xt.prototype.set=kr;const je=Xt,Er=function(e,t){var r=this.__data__;if(r instanceof ze){var n=r.__data__;if(!pe||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new je(n)}return r.set(e,t),this.size=r.size,this};function ge(e){var t=this.__data__=new ze(e);this.size=t.size}ge.prototype.clear=nr,ge.prototype.delete=Ee,ge.prototype.get=ue,ge.prototype.has=fe,ge.prototype.set=Er;const oe=ge,ir=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},sn=function(e){return this.__data__.has(e)};function xt(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new je;++t<r;)this.add(e[t])}xt.prototype.add=xt.prototype.push=ir,xt.prototype.has=sn;const We=xt,jr=function(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1},Or=function(e,t){return e.has(t)},sr=function(e,t,r,n,s,a){var l=1&r,h=e.length,C=t.length;if(h!=C&&!(l&&C>h))return!1;var N=a.get(e),z=a.get(t);if(N&&z)return N==t&&z==e;var P=-1,H=!0,Q=2&r?new We:void 0;for(a.set(e,t),a.set(t,e);++P<h;){var V=e[P],ot=t[P];if(n)var st=l?n(ot,V,P,t,e,a):n(V,ot,P,e,t,a);if(st!==void 0){if(st)continue;H=!1;break}if(Q){if(!jr(t,(function(_t,zt){if(!Or(Q,zt)&&(V===_t||s(V,_t,r,n,a)))return Q.push(zt)}))){H=!1;break}}else if(V!==ot&&!s(V,ot,r,n,a)){H=!1;break}}return a.delete(e),a.delete(t),H},ye=$t.Uint8Array,Bt=function(e){var t=-1,r=Array(e.size);return e.forEach((function(n,s){r[++t]=[s,n]})),r},Ar=function(e){var t=-1,r=Array(e.size);return e.forEach((function(n){r[++t]=n})),r};var ar=Zt?Zt.prototype:void 0,Je=ar?ar.valueOf:void 0;const Tr=function(e,t,r,n,s,a,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new ye(e),new ye(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Yt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var h=Bt;case"[object Set]":var C=1&n;if(h||(h=Ar),e.size!=t.size&&!C)return!1;var N=l.get(e);if(N)return N==t;n|=2,l.set(e,t);var z=sr(h(e),h(t),n,s,a,l);return l.delete(e),z;case"[object Symbol]":if(Je)return Je.call(e)==Je.call(t)}return!1},an=function(e,t){for(var r=-1,n=t.length,s=e.length;++r<n;)e[s+r]=t[r];return e},o=function(e,t,r){var n=t(e);return Lt(e)?n:an(n,r(e))},_=function(e,t){for(var r=-1,n=e==null?0:e.length,s=0,a=[];++r<n;){var l=e[r];t(l,r,e)&&(a[s++]=l)}return a},v=function(){return[]};var J=Object.prototype.propertyIsEnumerable,pt=Object.getOwnPropertySymbols;const bt=pt?function(e){return e==null?[]:(e=Object(e),_(pt(e),(function(t){return J.call(e,t)})))}:v,Et=function(e){return o(e,Re,bt)};var Oe=Object.prototype.hasOwnProperty;const Dt=function(e,t,r,n,s,a){var l=1&r,h=Et(e),C=h.length;if(C!=Et(t).length&&!l)return!1;for(var N=C;N--;){var z=h[N];if(!(l?z in t:Oe.call(t,z)))return!1}var P=a.get(e),H=a.get(t);if(P&&H)return P==t&&H==e;var Q=!0;a.set(e,t),a.set(t,e);for(var V=l;++N<C;){var ot=e[z=h[N]],st=t[z];if(n)var _t=l?n(st,ot,z,t,e,a):n(ot,st,z,e,t,a);if(!(_t===void 0?ot===st||s(ot,st,r,n,a):_t)){Q=!1;break}V||(V=z=="constructor")}if(Q&&!V){var zt=e.constructor,Te=t.constructor;zt==Te||!("constructor"in e)||!("constructor"in t)||typeof zt=="function"&&zt instanceof zt&&typeof Te=="function"&&Te instanceof Te||(Q=!1)}return a.delete(e),a.delete(t),Q},Ht=ee($t,"DataView"),It=ee($t,"Promise"),Ir=ee($t,"Set"),ln=ee($t,"WeakMap");var mn="[object Map]",gn="[object Promise]",yn="[object Set]",vn="[object WeakMap]",bn="[object DataView]",$n=wt(Ht),qn=wt(pe),Bn=wt(It),Hn=wt(Ir),Wn=wt(ln),Ae=ie;(Ht&&Ae(new Ht(new ArrayBuffer(1)))!=bn||pe&&Ae(new pe)!=mn||It&&Ae(It.resolve())!=gn||Ir&&Ae(new Ir)!=yn||ln&&Ae(new ln)!=vn)&&(Ae=function(e){var t=ie(e),r=t=="[object Object]"?e.constructor:void 0,n=r?wt(r):"";if(n)switch(n){case $n:return bn;case qn:return mn;case Bn:return gn;case Hn:return yn;case Wn:return vn}return t});const _n=Ae;var wn="[object Arguments]",xn="[object Array]",Mr="[object Object]",Sn=Object.prototype.hasOwnProperty;const Jn=function(e,t,r,n,s,a){var l=Lt(e),h=Lt(t),C=l?xn:_n(e),N=h?xn:_n(t),z=(C=C==wn?Mr:C)==Mr,P=(N=N==wn?Mr:N)==Mr,H=C==N;if(H&&Kt(e)){if(!Kt(t))return!1;l=!0,z=!1}if(H&&!z)return a||(a=new oe),l||Xe(e)?sr(e,t,r,n,s,a):Tr(e,t,C,r,n,s,a);if(!(1&r)){var Q=z&&Sn.call(e,"__wrapped__"),V=P&&Sn.call(t,"__wrapped__");if(Q||V){var ot=Q?e.value():e,st=V?t.value():t;return a||(a=new oe),s(ot,st,r,n,a)}}return!!H&&(a||(a=new oe),Dt(e,t,r,n,s,a))},Cn=function e(t,r,n,s,a){return t===r||(t==null||r==null||!kt(t)&&!kt(r)?t!=t&&r!=r:Jn(t,r,n,s,e,a))},Gn=function(e,t,r,n){var s=r.length,a=s;if(e==null)return!a;for(e=Object(e);s--;){var l=r[s];if(l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<a;){var h=(l=r[s])[0],C=e[h],N=l[1];if(l[2]){if(C===void 0&&!(h in e))return!1}else{var z=new oe,P;if(!(P===void 0?Cn(N,C,3,n,z):P))return!1}}return!0},kn=function(e){return e==e&&!Ie(e)},Vn=function(e){for(var t=Re(e),r=t.length;r--;){var n=t[r],s=e[n];t[r]=[n,s,kn(s)]}return t},En=function(e,t){return function(r){return r!=null&&r[e]===t&&(t!==void 0||e in Object(r))}},Zn=function(e){var t=Vn(e);return t.length==1&&t[0][2]?En(t[0][0],t[0][1]):function(r){return r===e||Gn(r,e,t)}},cn=function(e){return typeof e=="symbol"||kt(e)&&ie(e)=="[object Symbol]"};var Kn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Yn=/^\w*$/;const un=function(e,t){if(Lt(e))return!1;var r=typeof e;return!(r!="number"&&r!="symbol"&&r!="boolean"&&e!=null&&!cn(e))||Yn.test(e)||!Kn.test(e)||t!=null&&e in Object(t)};function fn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var r=function(){var n=arguments,s=t?t.apply(this,n):n[0],a=r.cache;if(a.has(s))return a.get(s);var l=e.apply(this,n);return r.cache=a.set(s,l)||a,l};return r.cache=new(fn.Cache||je),r}fn.Cache=je;const Xn=fn;var Qn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,to=/\\(\\)?/g;const eo=(function(e){var t=Xn(e,(function(n){return r.size===500&&r.clear(),n})),r=t.cache;return t})((function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Qn,(function(r,n,s,a){t.push(s?a.replace(to,"$1"):n||r)})),t})),ro=function(e,t){for(var r=-1,n=e==null?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s};var jn=Zt?Zt.prototype:void 0,On=jn?jn.toString:void 0;const no=function e(t){if(typeof t=="string")return t;if(Lt(t))return ro(t,e)+"";if(cn(t))return On?On.call(t):"";var r=t+"";return r=="0"&&1/t==-1/0?"-0":r},oo=function(e){return e==null?"":no(e)},An=function(e,t){return Lt(e)?e:un(e,t)?[e]:eo(oo(e))},Lr=function(e){if(typeof e=="string"||cn(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t},Tn=function(e,t){for(var r=0,n=(t=An(t,e)).length;e!=null&&r<n;)e=e[Lr(t[r++])];return r&&r==n?e:void 0},io=function(e,t,r){var n=e==null?void 0:Tn(e,t);return n===void 0?r:n},so=function(e,t){return e!=null&&t in Object(e)},ao=function(e,t,r){for(var n=-1,s=(t=An(t,e)).length,a=!1;++n<s;){var l=Lr(t[n]);if(!(a=e!=null&&r(e,l)))break;e=e[l]}return a||++n!=s?a:!!(s=e==null?0:e.length)&&Ce(s)&&Ne(l,s)&&(Lt(e)||mr(e))},lo=function(e,t){return e!=null&&ao(e,t,so)},co=function(e,t){return un(e)&&kn(t)?En(Lr(e),t):function(r){var n=io(r,e);return n===void 0&&n===t?lo(r,e):Cn(t,n,3)}},uo=function(e){return e},fo=function(e){return function(t){return t?.[e]}},po=function(e){return function(t){return Tn(t,e)}},ho=function(e){return un(e)?fo(Lr(e)):po(e)},mo=function(e){return typeof e=="function"?e:e==null?uo:typeof e=="object"?Lt(e)?co(e[0],e[1]):Zn(e):ho(e)},go=function(e,t){var r={};return t=mo(t),ae(e,(function(n,s,a){Yr(r,t(n,s,a),n)})),r};function In(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class yo{constructor(t,r){In(this,"ctx",void 0),In(this,"serviceHooks",void 0),this.ctx=t,this.serviceHooks=r,t._execCallableAPI("register-search-service",t.baseInfo.id,r.name,r.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:n=>(Lt(n?.blocks)&&(n.blocks=n.blocks.map((s=>s&&go(s,((a,l)=>`block/${l}`))))),n)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach((([n,s])=>{const a=(l=>`service:search:${l}:${r.name}`)(n);t.caller.on(a,(async l=>{if(w(r?.[s.f])){let h=null;try{h=await r[s.f].apply(r,(s.args||[]).map((C=>{if(l){if(C===!0)return l;if(l.hasOwnProperty(C)){const N=l[C];return delete l[C],N}}}))),s.transformOutput&&(h=s.transformOutput(h))}catch(C){console.error("[SearchService] ",C),h=C}finally{s.reply&&t.caller.call(`${a}:reply`,h)}}}))}))}}function lr(e,t,r){(function(n,s){if(s.has(n))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Wt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cr(e,t,r){return(function(n,s,a){if(s.set)s.set.call(n,a);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=a}})(e,Mn(e,t,"set"),r),r}function Qt(e,t){return(function(r,n){return n.get?n.get.call(r):n.value})(e,Mn(e,t,"get"))}function Mn(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}const vo=Symbol.for("proxy-continue"),bo=m()("LSPlugin:user"),Ln=new D("",{console:!0});function Ge(e,t,r){var n;const{key:s,label:a,desc:l,palette:h,keybinding:C,extras:N}=t;if(typeof r!="function")return this.logger.error(`${s||a}: command action should be function.`),!1;const z=(function(H){if(typeof H=="string")return H.trim().replace(/\s/g,"_").toLowerCase()})(s);if(!z)return this.logger.error(`${a}: command key is required.`),!1;const P=`SimpleCommandHook${z}${++Pn}`;this.Editor["on"+P](r),(n=this.caller)===null||n===void 0||n.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:z,label:a,type:e,desc:l,keybinding:C,extras:N},["editor/hook",P]],h]})}function Fn(e){return!(typeof(t=e)!="string"||t.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(t))||(Ln.error(`#${e} is not a valid UUID string.`),!1);var t}let Fr=null,Nn=new Map;const _o={async getInfo(e){return Fr||(Fr=await this._execCallableAPIAsync("get-app-info")),typeof e=="string"?Fr[e]:Fr},registerCommand:Ge,registerSearchService(e){if(Nn.has(e.name))throw new Error(`SearchService: #${e.name} has registered!`);Nn.set(e.name,new yo(this,e))},registerCommandPalette(e,t){const{key:r,label:n,keybinding:s}=e;return Ge.call(this,"$palette$",{key:r,label:n,palette:!0,keybinding:s},t)},registerCommandShortcut(e,t,r={}){typeof e=="string"&&(e={mode:"global",binding:e});const{binding:n}=e,s="$shortcut$",a=r.key||s+O(n?.toString());return Ge.call(this,s,{...r,key:a,palette:!1,keybinding:e},t)},registerUIItem(e,t){var r;const n=this.baseInfo.id;(r=this.caller)===null||r===void 0||r.call("api:call",{method:"register-plugin-ui-item",args:[n,e,t]})},registerPageMenuItem(e,t){if(typeof t!="function")return!1;const r=e+"_"+this.baseInfo.id,n=e;Ge.call(this,"page-menu-item",{key:r,label:n},t)},onBlockRendererSlotted(e,t){if(!Fn(e))return;const r=this.baseInfo.id,n=`hook:editor:${O(`slot:${e}`)}`;return this.caller.on(n,t),this.App._installPluginHook(r,n),()=>{this.caller.off(n,t),this.App._uninstallPluginHook(r,n)}},invokeExternalPlugin(e,...t){var r;if(!(e=(r=e)===null||r===void 0?void 0:r.trim()))return;let[n,s]=e.split(".");if(!["models","commands"].includes(s?.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const a=e.replace(`${n}.${s}.`,"");if(!n||!s||!a)throw new Error(`Illegal type of #${e} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",n,s.toLowerCase(),a,t)},setFullScreen(e){const t=(...r)=>this._callWin("setFullScreen",...r);e==="toggle"?this._callWin("isFullScreen").then((r=>{r?t():t(!0)})):e?t(!0):t()}};let Pn=0;const wo={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},isPageBlock:e=>e.uuid&&e.hasOwnProperty("name"),registerSlashCommand(e,t){var r;bo("Register slash command #",this.baseInfo.id,e,t),typeof t=="function"&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map((n=>{const[s,...a]=n;if(s==="editor/hook"){let l=a[0],h=()=>{var N;(N=this.caller)===null||N===void 0||N.callUserModel(l)};typeof l=="function"&&(h=l);const C=`SlashCommandHook${s}${++Pn}`;n[1]=C,this.Editor["on"+C](h)}return n})),(r=this.caller)===null||r===void 0||r.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[e,t]]})},registerBlockContextMenuItem(e,t){if(typeof t!="function")return!1;const r=e+"_"+this.baseInfo.id;Ge.call(this,"block-context-menu-item",{key:r,label:e},t)},registerHighlightContextMenuItem(e,t,r){if(typeof t!="function")return!1;const n=e+"_"+this.baseInfo.id;Ge.call(this,"highlight-context-menu-item",{key:n,label:e,extras:r},t)},scrollToBlockInPage(e,t,r){const n="block-content-"+t;r!=null&&r.replaceState?this.App.replaceState("page",{name:e},{anchor:n}):this.App.pushState("page",{name:e},{anchor:n})}},xo={onBlockChanged(e,t){if(!Fn(e))return;const r=this.baseInfo.id,n=`hook:db:${O(`block:${e}`)}`,s=({block:a,txData:l,txMeta:h})=>{a.uuid===e&&t(a,l,h)};return this.caller.on(n,s),this.App._installPluginHook(r,n),()=>{this.caller.off(n,s),this.App._uninstallPluginHook(r,n)}},datascriptQuery(e,...t){return t.pop(),t!=null&&t.some((r=>typeof r=="function"))?this.Experiments.ensureHostScope().logseq.api.datascript_query(e,...t):this._execCallableAPIAsync("datascript_query",e,...t)}},So={},Co={},ko={},Eo={makeSandboxStorage(){return new at(this,{assets:!0})}};var Nr=new WeakMap,Pr=new WeakMap,Rr=new WeakMap,Ur=new WeakMap,Dr=new WeakMap;class pn extends u(){constructor(t,r){super(),Wt(this,"_baseInfo",void 0),Wt(this,"_caller",void 0),Wt(this,"_version","0.2.2"),Wt(this,"_debugTag",""),Wt(this,"_settingsSchema",void 0),Wt(this,"_connected",!1),Wt(this,"_ui",new Map),Wt(this,"_mFileStorage",void 0),Wt(this,"_mRequest",void 0),Wt(this,"_mExperiments",void 0),Wt(this,"_beforeunloadCallback",void 0),lr(this,Nr,{writable:!0,value:void 0}),lr(this,Pr,{writable:!0,value:void 0}),lr(this,Rr,{writable:!0,value:void 0}),lr(this,Ur,{writable:!0,value:void 0}),lr(this,Dr,{writable:!0,value:void 0}),this._baseInfo=t,this._caller=r,r.on("sys:ui:visible",(n=>{n!=null&&n.toggle&&this.toggleMainUI()})),r.on("settings:changed",(n=>{const s=Object.assign({},this.settings),a=Object.assign(this._baseInfo.settings,n);this.emit("settings:changed",{...a},s)})),r.on("beforeunload",(async n=>{const{actor:s,...a}=n,l=this._beforeunloadCallback;try{l&&await l(a),s?.resolve(null)}catch(h){this.logger.error("[beforeunload] ",h),s?.reject(h)}}))}async ready(t,r){var n,s;if(!this._connected)try{var a;typeof t=="function"&&(r=t,t={});let l=await this._caller.connectToParent(t);this._connected=!0,n=this._baseInfo,s=l,l=E()(n,s,{arrayMerge:(h,C)=>C}),this._baseInfo=l,(a=l)!==null&&a!==void 0&&a.id&&(this._debugTag=this._caller.debugTag=`#${l.id} [${l.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(l.settings=(function(h,C){const N=(C||[]).reduce(((z,P)=>("default"in P&&(z[P.key]=P.default),z)),{});return Object.assign(N,h)})(l.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version,runtime:"js"})}catch(h){console.warn(h)}r&&r.call(this,l)}catch(l){console.error(`${this._debugTag} [Ready Error]`,l)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(t){typeof t=="function"&&(this._beforeunloadCallback=t)}provideModel(t){return this.caller._extendUserModel(t),this}provideTheme(t){return this.caller.call("provider:theme",t),this}provideStyle(t){return this.caller.call("provider:style",t),this}provideUI(t){return this.caller.call("provider:ui",t),this}useSettingsSchema(t){return this.connected&&this.caller.call("settings:schema",{schema:t,isSync:!0}),this._settingsSchema=t,this}updateSettings(t){this.caller.call("settings:update",t)}onSettingsChanged(t){const r="settings:changed";return this.on(r,t),()=>this.off(r,t)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(t){this.caller.call("main-ui:attrs",t)}setMainUIInlineStyle(t){this.caller.call("main-ui:style",t)}hideMainUI(t){const r={key:0,visible:!1,cursor:t?.restoreEditingCursor};this.caller.call("main-ui:visible",r),this.emit("ui:visible:changed",r),this._ui.set(r.key,r)}showMainUI(t){const r={key:0,visible:!0,autoFocus:t?.autoFocus};this.caller.call("main-ui:visible",r),this.emit("ui:visible:changed",r),this._ui.set(r.key,r)}toggleMainUI(){const r=this._ui.get(0);r&&r.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const t=this._ui.get(0);return!!(t&&t.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(t=this)&&(((r=t.baseInfo)===null||r===void 0?void 0:r.effect)||!((n=t.baseInfo)!==null&&n!==void 0&&n.iir));var t,r,n}get logger(){return Ln}get settings(){var t;return(t=this.baseInfo)===null||t===void 0?void 0:t.settings}get caller(){return this._caller}resolveResourceFullUrl(t){if(this.ensureConnected(),t)return t=t.replace(/^[.\\/]+/,""),A(this._baseInfo.lsr,t)}_makeUserProxy(t,r){const n=this,s=this.caller;return new Proxy(t,{get(a,l,h){const C=a[l];return function(...N){if(C){N?.length!==0&&N.concat(r);const P=C.apply(n,N);if(P!==vo)return P}if(r){const P=l.toString().match(/^(once|off|on)/i);if(P!=null){const H=P[0].toLowerCase(),Q=P.input,V=H==="off",ot=n.baseInfo.id;let st=Q.slice(H.length),_t=N[0],zt=N[1];typeof _t=="string"&&typeof zt=="function"&&(_t=_t.replace(/^logseq./,":"),st=`${st}${_t}`,_t=zt,zt=N[2]),st=`hook:${r}:${O(st)}`,s[H](st,_t);const Te=()=>{s.off(st,_t),s.listenerCount(st)||n.App._uninstallPluginHook(ot,st)};return V?void Te():(n.App._installPluginHook(ot,st,zt),Te)}}let z=l;return["git","ui","assets","utils"].includes(r)&&(z=r+"_"+z),s.callAsync("api:call",{tag:r,method:z,args:N})}}})}_execCallableAPIAsync(t,...r){return this._caller.callAsync("api:call",{method:t,args:r})}_execCallableAPI(t,...r){this._caller.call("api:call",{method:t,args:r})}_callWin(...t){return this._execCallableAPIAsync("_callMainWin",...t)}get App(){return Qt(this,Nr)?Qt(this,Nr):cr(this,Nr,this._makeUserProxy(_o,"app"))}get Editor(){return Qt(this,Pr)?Qt(this,Pr):cr(this,Pr,this._makeUserProxy(wo,"editor"))}get DB(){return Qt(this,Rr)?Qt(this,Rr):cr(this,Rr,this._makeUserProxy(xo,"db"))}get UI(){return Qt(this,Ur)?Qt(this,Ur):cr(this,Ur,this._makeUserProxy(Co,"ui"))}get Utils(){return Qt(this,Dr)?Qt(this,Dr):cr(this,Dr,this._makeUserProxy(ko,"utils"))}get Git(){return this._makeUserProxy(So,"git")}get Assets(){return this._makeUserProxy(Eo,"assets")}get FileStorage(){let t=this._mFileStorage;return t||(t=this._mFileStorage=new at(this)),t}get Request(){let t=this._mRequest;return t||(t=this._mRequest=new Ut(this)),t}get Experiments(){let t=this._mExperiments;return t||(t=this._mExperiments=new At(this)),t}}function Rn(e,t){return new pn(e,t)}if(window.__LSP__HOST__==null){const e=new Jt(null);window.logseq=Rn({},e)}})(),G})()))})(ur,ur.exports)),ur.exports}jo();const Oo={businessValue:[".bv","bv",".business-value","business-value"],timeCriticality:[".tc","tc",".time-criticality","time-criticality"],riskReduction:[".rr","rr",".risk-reduction","risk-reduction"],jobSize:[".js","js",".job-size","job-size"],wsjf:["WSJF","wsjf","priority"]},Ao=[{label:"Minor impact",value:1},{label:"Noticeable benefit",value:3},{label:"Major value",value:5},{label:"Business game-changer",value:8}],To=[{label:"No rush",value:1},{label:"Should be done soon",value:3},{label:"Deadline approaching",value:5},{label:"Urgent/must do now",value:8}],Io=[{label:"Little/No risk/opportunity",value:1},{label:"Helps/mitigates some risk",value:3},{label:"Mitigates key risk or opens new value",value:5},{label:"Removes critical risk / enables opportunity",value:8}],Mo=[{label:"S - Minimal effort",value:1},{label:"M - Manageable / a few hours",value:3},{label:"L - Medium / a day or two",value:5},{label:"XL - Big / a week+",value:8}];function $r(q,K){return q.map(et=>`<option value="${et.value}" ${K===et.value?"selected":""}>${et.label}</option>`).join("")}function ve(q,K){const et=Oo[K];for(const lt of et){const $=q[lt];if($!=null&&$!==""){const G=typeof $=="string"?parseFloat($):Number($);if(!isNaN(G))return G}}}function zn(q){const{businessValue:K,timeCriticality:et,riskReduction:lt,jobSize:$}=q;if(K===void 0||et===void 0||lt===void 0||$===void 0||$===0)return null;const G=K+et+lt;return Math.round(G/$*100)/100}function hn(q){return{businessValue:ve(q,"businessValue"),timeCriticality:ve(q,"timeCriticality"),riskReduction:ve(q,"riskReduction"),jobSize:ve(q,"jobSize")}}function Lo(q){const et=Math.round(q/24*100);return et>=90?"level-2":et>=75?"level-1":et>=60?"level-4":et>=40?"level-5":et>=20?"level-6":""}async function dn(q){try{const K=await logseq.Editor.getBlock(q,{includeChildren:!1});if(!K?.properties)return;const et=hn(K.properties),lt=zn(et),$=K.properties.wsjf!==void 0;let G="";if(lt!==null){const U=Math.round(lt/24*100);U>=75?G="red":U>=50?G="green":U>=25?G="blue":G="",G?await logseq.Editor.upsertBlockProperty(q,"background-color",G):await logseq.Editor.removeBlockProperty(q,"background-color"),$&&await logseq.Editor.removeBlockProperty(q,"wsjf"),K.properties.WSJF!==lt&&await logseq.Editor.upsertBlockProperty(q,"WSJF",lt)}else K.properties.WSJF!==void 0&&await logseq.Editor.removeBlockProperty(q,"WSJF"),$&&await logseq.Editor.removeBlockProperty(q,"wsjf"),await logseq.Editor.removeBlockProperty(q,"background-color")}catch(K){console.error("Error updating WSJF:",K)}}async function Dn(){try{const q=await logseq.Editor.getCurrentPage();if(!q){logseq.UI.showMsg("No page is currently open","warning");return}const K=q.originalName||q.name||q.name;if(!K){logseq.UI.showMsg("Could not get page name","error");return}const et=await logseq.Editor.getPageBlocksTree(K);let lt=0;async function $(G){if(G.properties){const U=hn(G.properties),f=zn(U);if(f!==null){G.properties.WSJF!==f&&(await logseq.Editor.upsertBlockProperty(G.uuid,"WSJF",f),lt++);const j=Lo(f);j?await logseq.Editor.upsertBlockProperty(G.uuid,".color",j):await logseq.Editor.removeBlockProperty(G.uuid,".color")}}if(G.children&&G.children.length>0)for(const U of G.children)await $(U)}for(const G of et)await $(G);logseq.UI.showMsg(`WSJF calculation complete: ${lt} blocks updated`,"success")}catch(q){console.error("Error updating page WSJF:",q),logseq.UI.showMsg("Error calculating WSJF","error")}}async function Fo(){const q=await logseq.Editor.getCurrentBlock();if(!q){logseq.UI.showMsg("Please place cursor in a block first","warning");return}const K=q.properties?hn(q.properties):{},et=`
    <div id="wsjf-form" style="padding: 20px; background: var(--ls-primary-background-color); border-radius: 8px; max-width: 400px;">
      <h3 style="margin-top: 0; color: var(--ls-primary-text-color);"> Prioritize</h3>
      <p style="font-size: 12px; color: var(--ls-secondary-text-color); margin-bottom: 20px;">
        Score each factor for this work task.
      </p>
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; color: var(--ls-primary-text-color); font-weight: 600;">
           Business Value:
        </label>
        <select id="wsjf-bv" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid var(--ls-border-color); background: var(--ls-secondary-background-color); color: var(--ls-primary-text-color);">
          <option value="">Select...</option>
          ${$r(Ao,K.businessValue)}
        </select>
      </div>
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; color: var(--ls-primary-text-color); font-weight: 600;">
           Time Criticality:
        </label>
        <select id="wsjf-tc" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid var(--ls-border-color); background: var(--ls-secondary-background-color); color: var(--ls-primary-text-color);">
          <option value="">Select...</option>
          ${$r(To,K.timeCriticality)}
        </select>
      </div>
      <div style="margin-bottom: 15px;">
        <label style="display: block; margin-bottom: 5px; color: var(--ls-primary-text-color); font-weight: 600;">
           Risk Reduction / Opportunity:
        </label>
        <select id="wsjf-rr" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid var(--ls-border-color); background: var(--ls-secondary-background-color); color: var(--ls-primary-text-color);">
          <option value="">Select...</option>
          ${$r(Io,K.riskReduction)}
        </select>
      </div>
      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 5px; color: var(--ls-primary-text-color); font-weight: 600;">
           Work Size:
        </label>
        <select id="wsjf-js" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid var(--ls-border-color); background: var(--ls-secondary-background-color); color: var(--ls-primary-text-color);">
          <option value="">Select...</option>
          ${$r(Mo,K.jobSize)}
        </select>
      </div>
      <div style="display: flex; gap: 10px;">
        <button id="wsjf-submit" style="flex: 1; padding: 10px; background: #3b82f6; color: white; border: none; border-radius: 4px; cursor: pointer; font-weight: 600;">
          Apply
        </button>
        <button id="wsjf-cancel" style="flex: 1; padding: 10px; background: var(--ls-secondary-background-color); color: var(--ls-primary-text-color); border: 1px solid var(--ls-border-color); border-radius: 4px; cursor: pointer;">
          Cancel
        </button>
      </div>
    </div>
  `;logseq.provideUI({key:"wsjf-form-modal",template:et,style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:999,boxShadow:"0 4px 20px rgba(0,0,0,0.3)"}}),setTimeout(()=>{const lt=parent.document.getElementById("wsjf-submit"),$=parent.document.getElementById("wsjf-cancel");lt?.addEventListener("click",async()=>{const G=parseInt(parent.document.getElementById("wsjf-bv")?.value||"0"),U=parseInt(parent.document.getElementById("wsjf-tc")?.value||"0"),f=parseInt(parent.document.getElementById("wsjf-rr")?.value||"0"),E=parseInt(parent.document.getElementById("wsjf-js")?.value||"0");if(!G||!U||!f||!E){logseq.UI.showMsg("Please fill all fields","warning");return}await logseq.Editor.upsertBlockProperty(q.uuid,".bv",G),await logseq.Editor.upsertBlockProperty(q.uuid,".tc",U),await logseq.Editor.upsertBlockProperty(q.uuid,".rr",f),await logseq.Editor.upsertBlockProperty(q.uuid,".js",E),logseq.provideUI({key:"wsjf-form-modal",template:""}),logseq.UI.showMsg("Task prioritized!","success"),setTimeout(()=>dn(q.uuid),500)}),$?.addEventListener("click",()=>{logseq.provideUI({key:"wsjf-form-modal",template:""})})},100)}function No(){logseq.Editor.registerSlashCommand("WSJF: Prioritize",Fo),logseq.Editor.registerSlashCommand("Calculate WSJF",async()=>{await Dn()}),logseq.Editor.registerBlockContextMenuItem("Calculate WSJF for this block",async q=>{await dn(q.uuid),logseq.UI.showMsg("WSJF calculated","success")}),logseq.App.registerUIItem("toolbar",{key:"wsjf-calculator",template:'<a class="button" data-on-click="calculateWSJF" title="Calculate WSJF for current page"><i class="ti ti-calculator"></i></a>'}),logseq.provideModel({calculateWSJF:async()=>{await Dn()}}),logseq.DB.onChanged(async q=>{if(q.blocks?.length){for(const K of q.blocks)if(K.properties){const et=K.properties;(ve(et,"businessValue")!==void 0||ve(et,"timeCriticality")!==void 0||ve(et,"riskReduction")!==void 0||ve(et,"jobSize")!==void 0)&&setTimeout(()=>{dn(K.uuid)},300)}}}),logseq.UI.showMsg("WSJF Priority Calculator ready!","success")}logseq.ready(No).catch(console.error);
